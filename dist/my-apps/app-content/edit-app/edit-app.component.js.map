{"version":3,"sources":["my-apps/app-content/edit-app/edit-app.component.ts"],"names":[],"mappings":"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","file":"my-apps/app-content/edit-app/edit-app.component.js","sourcesContent":["import { Component, Input, OnInit } from \"@angular/core\";\nimport { FormBuilder, ControlGroup, AbstractControl, Validators } from \"@angular/common\";\n\nimport Carbon from \"carbonldp/Carbon\";\nimport * as HTTP from \"carbonldp/HTTP\";\nimport * as PersistedApp from \"carbonldp/PersistedApp\";\n\nimport * as App from \"../app\";\nimport { ErrorMessageComponent, Message } from \"../../../errors-area/error-message.component\";\n\nimport \"semantic-ui/semantic\";\n\nimport template from \"./edit-app.component.html!\";\nimport style from \"./edit-app.component.css!text\";\n\n@Component( {\n\tselector: \"cp-edit-app\",\n\ttemplate: template,\n\tstyles: [ style ],\n\tdirectives: [ ErrorMessageComponent ],\n} )\n\nexport class EditAppComponent implements OnInit {\n\n\tsubmitting:boolean = false;\n\tdisplaySuccessMessage:boolean = false;\n\terrorMessage:Message;\n\n\teditAppForm:ControlGroup;\n\tcorsGroup:ControlGroup;\n\tformBuilder:FormBuilder;\n\tname:AbstractControl;\n\tdescription:AbstractControl;\n\tallDomains:AbstractControl;\n\tdomain:AbstractControl;\n\n\tallowedDomains:string[] = [];\n\tdomainStr:string = \"\";\n\n\t// Inputs and Outputs\n\t@Input() app:App.Class;\n\n\n\tconstructor( formBuilder:FormBuilder ) {\n\t\tthis.formBuilder = formBuilder;\n\t}\n\n\tngOnInit():void {\n\t\tlet allowAllOrigins:boolean = false;\n\t\tif( ! ! this.app.allowsOrigins && this.app.allowsOrigins.length > 0 ) {\n\t\t\tallowAllOrigins = this.app.allowsOrigins[ 0 ][ \"id\" ] === Carbon.NS.CS.Class.AllOrigins;\n\t\t\tif( ! allowAllOrigins )this.allowedDomains = <string[]>this.app.allowsOrigins;\n\t\t}\n\n\t\tthis.editAppForm = this.formBuilder.group( {\n\t\t\tname: [ this.app.name, Validators.compose( [ Validators.required ] ) ],\n\t\t\tdescription: [ this.app.description, Validators.compose( [ Validators.required ] ) ],\n\t\t\tcors: this.formBuilder.group( {\n\t\t\t\tallDomains: [ allowAllOrigins ],\n\t\t\t\tdomain: [ this.domainStr ],\n\t\t\t\tallowedDomains: [ this.allowedDomains ],\n\t\t\t}, { validator: Validators.compose( [ this.domainValidator, this.allowedDomainsValidator ] ) } ),\n\t\t} );\n\t\tthis.name = this.editAppForm.controls[ \"name\" ];\n\t\tthis.description = this.editAppForm.controls[ \"description\" ];\n\t\tthis.corsGroup = <ControlGroup>this.editAppForm.controls[ \"cors\" ];\n\t\tthis.allDomains = this.corsGroup.controls[ \"allDomains\" ];\n\t\tthis.domain = this.corsGroup.controls[ \"domain\" ];\n\t}\n\n\tdomainValidator( corsGroup:ControlGroup ):any {\n\t\tlet allDomains:AbstractControl = corsGroup.controls[ \"allDomains\" ];\n\t\tlet domain:AbstractControl = corsGroup.controls[ \"domain\" ];\n\t\tif( allDomains.value || (! allDomains.value && ! ! domain.value && ! ! domain.value.match( /^http(s?):\\/\\/((\\w+\\.)?\\w+\\.\\w+|((2[0-5]{2}|1[0-9]{2}|[0-9]{1,2})\\.){3}(2[0-5]{2}|1[0-9]{2}|[0-9]{1,2}))(\\/)?$/gm ) ) ) {\n\t\t\treturn null;\n\t\t}\n\t\tif( ! ! domain.value ) {\n\t\t\treturn { \"invalidURLAddress\": true };\n\t\t}\n\t}\n\n\tallowedDomainsValidator( corsGroup:ControlGroup ):any {\n\t\tif( ! corsGroup.value[ \"allDomains\" ] && (<string[]>corsGroup.value[ \"allowedDomains\" ]).length <= 0 ) {\n\t\t\treturn { \"emptyAllowedAddresses\": true };\n\t\t}\n\t\treturn null;\n\t}\n\n\taddDomain( domain:string ):void {\n\t\tif( this.domain.valid && ! ! domain ) this.allowedDomains.push( domain );\n\t\tthis.corsGroup.updateValueAndValidity();\n\t}\n\n\tremoveDomain( option:string ):void {\n\t\tlet idx:number = this.allowedDomains.indexOf( option );\n\t\tif( idx >= 0 ) {\n\t\t\tthis.allowedDomains.splice( idx, 1 );\n\t\t\tthis.corsGroup.updateValueAndValidity();\n\t\t}\n\t}\n\n\tcanDisplayErrors():boolean {\n\t\treturn (! this.name.pristine && ! this.name.valid) || (! this.description.pristine && ! this.description.valid);\n\t}\n\n\tonSubmit( data:{ name:string, description:string, cors:{allDomains:boolean, domain:string, allowedDomains:string[], } }, $event:Event ):void {\n\t\t$event.preventDefault();\n\n\t\tthis.submitting = true;\n\t\tthis.errorMessage = null;\n\n\t\tthis.name.markAsDirty( true );\n\t\tthis.description.markAsDirty( true );\n\n\t\tif( ! this.editAppForm.valid ) {\n\t\t\tthis.submitting = false;\n\t\t\treturn;\n\t\t}\n\n\t\tlet name:string = data.name;\n\t\tlet description:string = data.description;\n\t\tlet allowsAllOrigin:any = data.cors.allDomains;\n\t\tlet allowedDomains:string[] = data.cors.allowedDomains;\n\n\t\tif( name ) this.app.name = name;\n\t\tif( description ) this.app.description = description;\n\t\tif( allowsAllOrigin ) {\n\t\t\tthis.app.allowsOrigins = [ Carbon.Pointer.Factory.create( Carbon.NS.CS.Class.AllOrigins ) ];\n\t\t} else {\n\t\t\tthis.app.allowsOrigins = allowedDomains.length > 0 ? allowedDomains : this.app.allowsOrigins;\n\t\t}\n\n\t\tthis.app.save().then( ( [updatedApp, response]:[PersistedApp.Class, HTTP.Response.Class] ) => {\n\t\t\tthis.displaySuccessMessage = true;\n\t\t\treturn this.app.refresh();\n\t\t} ).catch( ( error:HTTP.Errors.Error ):void => {\n\t\t\tthis.errorMessage = {\n\t\t\t\ttitle: error.name,\n\t\t\t\tcontent: this.getErrorMessage( error ),\n\t\t\t\tstatusCode: \"\" + error.response.status,\n\t\t\t\tstatusMessage: (<XMLHttpRequest>error.response.request).statusText,\n\t\t\t\tendpoint: (<any>error.response.request).responseURL,\n\t\t\t};\n\t\t} ).then( ( [updatedApp, response]:[PersistedApp.Class, HTTP.Response.Class] ):void => {\n\t\t\tthis.submitting = false;\n\t\t} );\n\t}\n\n\tgetErrorMessage( error:HTTP.Errors.Error ):string {\n\t\tlet tempMessage:string = \"\";\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.BadRequestError:\n\t\t\t\ttempMessage = \"\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ConflictError:\n\t\t\t\ttempMessage = \"There's already a resource with that slug. Error:\" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\ttempMessage = \"Forbidden Action.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.NotFoundError:\n\t\t\t\ttempMessage = \"Couldn't found the requested URL.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.RequestEntityTooLargeError:\n\t\t\t\ttempMessage = \"Request entity too large.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\ttempMessage = \"Unauthorized operation.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\ttempMessage = \"An internal error occurred while trying to update the app. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\ttempMessage = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\ttempMessage = \"An error occurred while trying to update the app. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttempMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn tempMessage;\n\t}\n\n\tclearMessages( evt:Event ):void {\n\t\tthis.displaySuccessMessage = false;\n\t\tthis.errorMessage = null;\n\t}\n}\n\nexport default EditAppComponent;\n"],"sourceRoot":"/source/"}