{"version":3,"sources":["my-apps/app-content/edit-app/edit-app.component.ts"],"names":[],"mappings":"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","file":"edit-app.component.js","sourcesContent":["import { Component, Input, OnInit } from \"@angular/core\";\n\nimport Carbon from \"carbonldp/Carbon\";\nimport * as HTTP from \"carbonldp/HTTP\";\nimport * as URI from \"carbonldp/RDF/URI\";\nimport * as PersistedApp from \"carbonldp/PersistedApp\";\n\nimport { AppContextService } from \"../../app-context.service\";\nimport * as App from \"../app\";\n\nimport { Message } from \"../../../errors-area/error-message.component\";\n\nimport \"semantic-ui/semantic\";\n\nimport template from \"./edit-app.component.html!\";\nimport style from \"./edit-app.component.css!text\";\n\n@Component( {\n\tselector: \"cp-edit-app\",\n\ttemplate: template,\n\tstyles: [ style ],\n} )\n\nexport class EditAppComponent implements OnInit {\n\n\tappContextService:AppContextService;\n\n\tsubmitting:boolean = false;\n\tdisplaySuccessMessage:boolean = false;\n\terrorMessage:Message;\n\n\teditAppFormModel:{ name:string, description:string, allDomains:boolean, domain:string } = {\n\t\tname: \"\",\n\t\tdescription: \"\",\n\t\tallDomains: true,\n\t\tdomain: \"\"\n\t};\n\n\tallowedDomains:string[] = [];\n\t// Inputs and Outputs\n\t@Input() app:App.Class;\n\n\n\tconstructor( appContextService:AppContextService ) {\n\t\tthis.appContextService = appContextService;\n\t}\n\n\tngOnInit():void {\n\t\tlet allowAllOrigins:boolean = false;\n\t\tif( ! ! this.app.allowsOrigins && this.app.allowsOrigins.length > 0 ) {\n\t\t\tallowAllOrigins = this.app.allowsOrigins[ 0 ][ \"id\" ] === Carbon.NS.CS.Class.AllOrigins;\n\t\t\tif( ! allowAllOrigins ) this.allowedDomains = <string[]>this.app.allowsOrigins;\n\t\t}\n\n\t\tthis.editAppFormModel.name = this.app.name;\n\t\tthis.editAppFormModel.description = this.app.description;\n\t\tthis.editAppFormModel.allDomains = allowAllOrigins;\n\t}\n\n\taddDomain( domain:any ):void {\n\t\tif( domain.valid && ! ! domain.value ) {\n\t\t\tthis.allowedDomains.push( domain.value );\n\t\t}\n\t}\n\n\tremoveDomain( option:string, allDomains:any ):void {\n\t\tlet idx:number = this.allowedDomains.indexOf( option );\n\t\tif( idx >= 0 ) {\n\t\t\tthis.allowedDomains.splice( idx, 1 );\n\t\t}\n\t}\n\n\tonSubmit( form, $event:Event ):void {\n\t\t$event.preventDefault();\n\n\t\tthis.submitting = true;\n\t\tthis.errorMessage = null;\n\t\tlet name:string = form.value.name;\n\t\tlet description:string = form.value.description;\n\t\tlet allowsAllOrigins:any = form.value.allowAllOrigins;\n\t\tlet allowedDomains = this.allowedDomains;\n\n\t\tif( ! form.valid || (form.valid && (! allowsAllOrigins && allowedDomains.length === 0)) ) {\n\t\t\tthis.submitting = false;\n\t\t\treturn;\n\t\t}\n\n\n\t\tif( name ) this.app.name = name;\n\t\tif( description ) this.app.description = description;\n\t\tif( allowsAllOrigins ) {\n\t\t\tthis.app.allowsOrigins = [ Carbon.Pointer.Factory.create( Carbon.NS.CS.Class.AllOrigins ) ];\n\t\t} else {\n\t\t\tthis.app.allowsOrigins = allowedDomains.length > 0 ? allowedDomains : this.app.allowsOrigins;\n\t\t}\n\n\t\tthis.app.saveAndRefresh().then( ( [ updatedApp, response ]:[ PersistedApp.Class, [ HTTP.Response.Class, HTTP.Response.Class ] ] ) => {\n\t\t\tthis.displaySuccessMessage = true;\n\t\t\tlet slug:string = URI.Util.getSlug( updatedApp.id );\n\t\t\treturn this.appContextService.updateContext( slug );\n\t\t} ).catch( ( error:HTTP.Errors.Error ):void => {\n\t\t\tthis.errorMessage = {\n\t\t\t\ttitle: error.name,\n\t\t\t\tcontent: this.getErrorMessage( error ),\n\t\t\t\tstatusCode: \"\" + error.response.status,\n\t\t\t\tstatusMessage: (<XMLHttpRequest>error.response.request).statusText,\n\t\t\t\tendpoint: (<any>error.response.request).responseURL,\n\t\t\t};\n\t\t} ).then( ():void => {\n\t\t\tthis.submitting = false;\n\t\t} );\n\t}\n\n\tgetErrorMessage( error:HTTP.Errors.Error ):string {\n\t\tlet tempMessage:string = \"\";\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.BadRequestError:\n\t\t\t\ttempMessage = \"\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ConflictError:\n\t\t\t\ttempMessage = \"There's already a resource with that slug. Error:\" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\ttempMessage = \"Forbidden Action.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.NotFoundError:\n\t\t\t\ttempMessage = \"Couldn't found the requested URL.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.RequestEntityTooLargeError:\n\t\t\t\ttempMessage = \"Request entity too large.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\ttempMessage = \"Unauthorized operation.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\ttempMessage = \"An internal error occurred while trying to update the app. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\ttempMessage = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\ttempMessage = \"An error occurred while trying to update the app. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttempMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn tempMessage;\n\t}\n\n\tclearMessages( evt:Event ):void {\n\t\tthis.displaySuccessMessage = false;\n\t\tthis.errorMessage = null;\n\t}\n}\n\nexport default EditAppComponent;\n"]}