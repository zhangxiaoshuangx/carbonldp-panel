{"version":3,"sources":["my-apps/app-content/edit-app/edit-app.component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAwBA;gBAoBC,0BAAa,iBAAmC;oBAhBhD,eAAU,GAAW,KAAK,CAAC;oBAC3B,0BAAqB,GAAW,KAAK,CAAC;oBAGtC,qBAAgB,GAA0E;wBACzF,IAAI,EAAE,EAAE;wBACR,WAAW,EAAE,EAAE;wBACf,UAAU,EAAE,IAAI;wBAChB,MAAM,EAAE,EAAE;qBACV,CAAC;oBAEF,mBAAc,GAAY,EAAE,CAAC;oBAM5B,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;gBAC5C,CAAC;gBAED,mCAAQ,GAAR;oBACC,IAAI,eAAe,GAAW,KAAK,CAAC;oBACpC,EAAE,CAAA,CAAE,CAAE,CAAE,IAAI,CAAC,GAAG,CAAC,aAAa,IAAI,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,MAAM,GAAG,CAAE,CAAC,CAAC,CAAC;wBACtE,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAE,CAAC,CAAE,CAAE,IAAI,CAAE,KAAK,gBAAM,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC;wBACxF,EAAE,CAAA,CAAE,CAAE,eAAgB,CAAC;4BAAC,IAAI,CAAC,cAAc,GAAa,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC;oBAChF,CAAC;oBAED,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;oBAC3C,IAAI,CAAC,gBAAgB,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;oBACzD,IAAI,CAAC,gBAAgB,CAAC,UAAU,GAAG,eAAe,CAAC;gBACpD,CAAC;gBAED,oCAAS,GAAT,UAAW,MAAU;oBACpB,EAAE,CAAA,CAAE,MAAM,CAAC,KAAK,IAAI,CAAE,CAAE,MAAM,CAAC,KAAM,CAAC,CAAC,CAAC;wBACvC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAE,MAAM,CAAC,KAAK,CAAE,CAAC;oBAC1C,CAAC;gBACF,CAAC;gBAED,uCAAY,GAAZ,UAAc,MAAa,EAAE,UAAc;oBAC1C,IAAI,GAAG,GAAU,IAAI,CAAC,cAAc,CAAC,OAAO,CAAE,MAAM,CAAE,CAAC;oBACvD,EAAE,CAAA,CAAE,GAAG,IAAI,CAAE,CAAC,CAAC,CAAC;wBACf,IAAI,CAAC,cAAc,CAAC,MAAM,CAAE,GAAG,EAAE,CAAC,CAAE,CAAC;oBACtC,CAAC;gBACF,CAAC;gBAED,mCAAQ,GAAR,UAAU,IAAI,EAAE,MAAY;oBAA5B,iBAkCC;oBAjCA,MAAM,CAAC,cAAc,EAAE,CAAC;oBAExB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;oBACzB,IAAI,IAAI,GAAU,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;oBAClC,IAAI,WAAW,GAAU,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;oBAChD,IAAI,gBAAgB,GAAO,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC;oBACtD,IAAI,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC;oBAEzC,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,CAAE,gBAAgB,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC;wBAC1F,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;wBACxB,MAAM,CAAC;oBACR,CAAC;oBAGD,EAAE,CAAA,CAAE,IAAK,CAAC;wBAAC,IAAI,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC;oBAChC,EAAE,CAAA,CAAE,WAAY,CAAC;wBAAC,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,WAAW,CAAC;oBACrD,EAAE,CAAA,CAAE,gBAAiB,CAAC,CAAC,CAAC;wBACvB,IAAI,CAAC,GAAG,CAAC,aAAa,GAAG,CAAE,gBAAM,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAE,gBAAM,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,UAAU,CAAE,CAAE,CAAC;oBAC7F,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,IAAI,CAAC,GAAG,CAAC,aAAa,GAAG,cAAc,CAAC,MAAM,GAAG,CAAC,GAAG,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC;oBAC9F,CAAC;oBAED,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC,IAAI,CAAE,UAAE,EAA6F;4BAA3F,kBAAU,EAAE,gBAAQ;wBACvD,KAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC;wBAClC,IAAI,IAAI,GAAU,GAAG,CAAC,IAAI,CAAC,OAAO,CAAE,UAAU,CAAC,EAAE,CAAE,CAAC;wBACpD,MAAM,CAAC,KAAI,CAAC,iBAAiB,CAAC,aAAa,CAAE,IAAI,CAAE,CAAC;oBACrD,CAAC,CAAE,CAAC,KAAK,CAAE,UAAE,KAAuB;wBACnC,KAAI,CAAC,YAAY,GAAG,+CAAqB,CAAC,eAAe,CAAE,KAAK,CAAE,CAAA;wBAClE,KAAI,CAAC,YAAY,CAAC,OAAO,GAAG,KAAI,CAAC,eAAe,CAAE,KAAK,CAAE,CAAC;oBAC3D,CAAC,CAAE,CAAC,IAAI,CAAE;wBACT,KAAI,CAAC,UAAU,GAAG,KAAK,CAAC;oBACzB,CAAC,CAAE,CAAC;gBACL,CAAC;gBAED,0CAAe,GAAf,UAAiB,KAAuB;oBACvC,IAAI,WAAW,GAAU,EAAE,CAAC;oBAC5B,MAAM,CAAA,CAAE,IAAK,CAAC,CAAC,CAAC;wBACf,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,eAAe;4BAChD,WAAW,GAAG,EAAE,CAAC;4BACjB,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,aAAa;4BAC9C,WAAW,GAAG,mDAAmD,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC;4BAC1F,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,cAAc;4BAC/C,WAAW,GAAG,mBAAmB,CAAC;4BAClC,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,aAAa;4BAC9C,WAAW,GAAG,mCAAmC,CAAC;4BAClD,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,0BAA0B;4BAC3D,WAAW,GAAG,2BAA2B,CAAC;4BAC1C,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,iBAAiB;4BAClD,WAAW,GAAG,yBAAyB,CAAC;4BACxC,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,wBAAwB;4BACzD,WAAW,GAAG,4FAA4F,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC;4BACnI,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,uBAAuB;4BACxD,WAAW,GAAG,gCAAgC,CAAC;4BAC/C,KAAK,CAAC;wBACP,KAAK,KAAK,YAAY,IAAI,CAAC,MAAM,CAAC,YAAY;4BAC7C,WAAW,GAAG,mFAAmF,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC;4BAC1H,KAAK,CAAC;wBACP;4BACC,WAAW,GAAG,qDAAqD,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC;4BAC5F,KAAK,CAAC;oBACR,CAAC;oBACD,MAAM,CAAC,WAAW,CAAC;gBACpB,CAAC;gBAED,wCAAa,GAAb,UAAe,GAAS;oBACvB,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;oBACnC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBAC1B,CAAC;gBA5GD;oBAAC,YAAK,EAAE;;6DAAA;gBAvBT;oBAAC,gBAAS,CAAE;wBACX,QAAQ,EAAE,aAAa;wBACvB,QAAQ,EAAE,iCAAQ;wBAClB,MAAM,EAAE,CAAE,qCAAK,CAAE;qBACjB,CAAE;;oCAAA;gBAgIH,uBAAC;YAAD,CA9HA,AA8HC,IAAA;YA9HD,+CA8HC,CAAA;YAED,oBAAe,gBAAgB,EAAC","file":"edit-app.component.js","sourcesContent":["import { Component, Input, OnInit } from \"@angular/core\";\n\nimport Carbon from \"carbonldp/Carbon\";\nimport * as HTTP from \"carbonldp/HTTP\";\nimport * as URI from \"carbonldp/RDF/URI\";\nimport * as PersistedApp from \"carbonldp/PersistedApp\";\n\nimport { AppContextService } from \"../../app-context.service\";\nimport * as App from \"../app\";\n\nimport { Message } from \"carbonldp-panel/messages-area/message.component\";\nimport { ErrorMessageGenerator } from \"carbonldp-panel/messages-area/error/error-message-generator\";\n\nimport \"semantic-ui/semantic\";\n\nimport template from \"./edit-app.component.html!\";\nimport style from \"./edit-app.component.css!text\";\n\n@Component( {\n\tselector: \"cp-edit-app\",\n\ttemplate: template,\n\tstyles: [ style ],\n} )\n\nexport class EditAppComponent implements OnInit {\n\n\tappContextService:AppContextService;\n\n\tsubmitting:boolean = false;\n\tdisplaySuccessMessage:boolean = false;\n\terrorMessage:Message;\n\n\teditAppFormModel:{ name:string, description:string, allDomains:boolean, domain:string } = {\n\t\tname: \"\",\n\t\tdescription: \"\",\n\t\tallDomains: true,\n\t\tdomain: \"\"\n\t};\n\n\tallowedDomains:string[] = [];\n\t// Inputs and Outputs\n\t@Input() app:App.Class;\n\n\n\tconstructor( appContextService:AppContextService ) {\n\t\tthis.appContextService = appContextService;\n\t}\n\n\tngOnInit():void {\n\t\tlet allowAllOrigins:boolean = false;\n\t\tif( ! ! this.app.allowsOrigins && this.app.allowsOrigins.length > 0 ) {\n\t\t\tallowAllOrigins = this.app.allowsOrigins[ 0 ][ \"id\" ] === Carbon.NS.CS.Class.AllOrigins;\n\t\t\tif( ! allowAllOrigins ) this.allowedDomains = <string[]>this.app.allowsOrigins;\n\t\t}\n\n\t\tthis.editAppFormModel.name = this.app.name;\n\t\tthis.editAppFormModel.description = this.app.description;\n\t\tthis.editAppFormModel.allDomains = allowAllOrigins;\n\t}\n\n\taddDomain( domain:any ):void {\n\t\tif( domain.valid && ! ! domain.value ) {\n\t\t\tthis.allowedDomains.push( domain.value );\n\t\t}\n\t}\n\n\tremoveDomain( option:string, allDomains:any ):void {\n\t\tlet idx:number = this.allowedDomains.indexOf( option );\n\t\tif( idx >= 0 ) {\n\t\t\tthis.allowedDomains.splice( idx, 1 );\n\t\t}\n\t}\n\n\tonSubmit( form, $event:Event ):void {\n\t\t$event.preventDefault();\n\n\t\tthis.submitting = true;\n\t\tthis.errorMessage = null;\n\t\tlet name:string = form.value.name;\n\t\tlet description:string = form.value.description;\n\t\tlet allowsAllOrigins:any = form.value.allowAllOrigins;\n\t\tlet allowedDomains = this.allowedDomains;\n\n\t\tif( ! form.valid || (form.valid && (! allowsAllOrigins && allowedDomains.length === 0)) ) {\n\t\t\tthis.submitting = false;\n\t\t\treturn;\n\t\t}\n\n\n\t\tif( name ) this.app.name = name;\n\t\tif( description ) this.app.description = description;\n\t\tif( allowsAllOrigins ) {\n\t\t\tthis.app.allowsOrigins = [ Carbon.Pointer.Factory.create( Carbon.NS.CS.Class.AllOrigins ) ];\n\t\t} else {\n\t\t\tthis.app.allowsOrigins = allowedDomains.length > 0 ? allowedDomains : this.app.allowsOrigins;\n\t\t}\n\n\t\tthis.app.saveAndRefresh().then( ( [ updatedApp, response ]:[ PersistedApp.Class, [ HTTP.Response.Class, HTTP.Response.Class ] ] ) => {\n\t\t\tthis.displaySuccessMessage = true;\n\t\t\tlet slug:string = URI.Util.getSlug( updatedApp.id );\n\t\t\treturn this.appContextService.updateContext( slug );\n\t\t} ).catch( ( error:HTTP.Errors.Error ):void => {\n\t\t\tthis.errorMessage = ErrorMessageGenerator.getErrorMessage( error )\n\t\t\tthis.errorMessage.content = this.getErrorMessage( error );\n\t\t} ).then( ():void => {\n\t\t\tthis.submitting = false;\n\t\t} );\n\t}\n\n\tgetErrorMessage( error:HTTP.Errors.Error ):string {\n\t\tlet tempMessage:string = \"\";\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.BadRequestError:\n\t\t\t\ttempMessage = \"\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ConflictError:\n\t\t\t\ttempMessage = \"There's already a resource with that slug. Error:\" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\ttempMessage = \"Forbidden Action.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.NotFoundError:\n\t\t\t\ttempMessage = \"Couldn't found the requested URL.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.RequestEntityTooLargeError:\n\t\t\t\ttempMessage = \"Request entity too large.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\ttempMessage = \"Unauthorized operation.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\ttempMessage = \"An internal error occurred while trying to update the app. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\ttempMessage = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\ttempMessage = \"An error occurred while trying to update the app. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttempMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn tempMessage;\n\t}\n\n\tclearMessages( evt:Event ):void {\n\t\tthis.displaySuccessMessage = false;\n\t\tthis.errorMessage = null;\n\t}\n}\n\nexport default EditAppComponent;\n"]}