{"version":3,"sources":["my-apps/app-content/explorer/document-explorer/blank-nodes/blank-nodes.component.ts"],"names":[],"mappings":"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","file":"my-apps/app-content/explorer/document-explorer/blank-nodes/blank-nodes.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, EventEmitter, SimpleChange, AfterViewInit, OnChanges } from \"@angular/core\";\n\nimport * as RDFNode from \"carbonldp/RDF/RDFNode\";\nimport * as Utils from \"carbonldp/Utils\";\n\nimport { BlankNodeComponent, BlankNode, BlankNodeRecords, BlankNodeRow } from \"./blank-node.component\"\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport template from \"./blank-nodes.component.html!\";\nimport style from \"./blank-nodes.component.css!text\";\n\n@Component( {\n\tselector: \"cp-blank-nodes\",\n\ttemplate: template,\n\tstyles: [ style ],\n\tdirectives: [ BlankNodeComponent ],\n} )\n\nexport class BlankNodesComponent implements AfterViewInit, OnChanges {\n\n\telement:ElementRef;\n\t$element:JQuery;\n\n\tnodesTab:JQuery;\n\topenedBlankNodes:BlankNodeRow[] = [];\n\tblankNodesRecords:BlankNodesRecords = new BlankNodesRecords();\n\taskingDeletionBlankNode:BlankNodeRow;\n\n\t@Input() blankNodes:BlankNodeRow[] = [];\n\t@Input() namedFragments:RDFNode.Class[] = [];\n\t@Input() documentURI:string = \"\";\n\n\t@Output() onChanges:EventEmitter<BlankNodesRecords> = new EventEmitter<BlankNodesRecords>();\n\t@Output() onOpenBNode:EventEmitter<string> = new EventEmitter<string>();\n\t@Output() onOpenNamedFragment:EventEmitter<string> = new EventEmitter<string>();\n\n\tconstructor( element:ElementRef ) {\n\t\tthis.element = element;\n\t}\n\n\tngAfterViewInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.nodesTab = this.$element.find( \".tabular.blank-nodes.menu\" ).tab();\n\t\tthis.initializeDeletionDimmer();\n\t}\n\n\tngOnChanges( changes:{[propName:string]:SimpleChange} ):void {\n\t\tif( ( changes[ \"blankNodes\" ].currentValue !== changes[ \"blankNodes\" ].previousValue ) ) {\n\t\t\tconsole.log( this.blankNodes );\n\t\t\tthis.openedBlankNodes = [];\n\t\t\tthis.goToBlankNode( \"all\" );\n\t\t\tthis.blankNodesRecords.clear();\n\t\t}\n\t}\n\n\topenBlankNode( nodeOrId:RDFNode.Class|string ):void {\n\t\tlet node:BlankNodeRow;\n\t\tif( typeof nodeOrId === \"string\" ) {\n\t\t\tnode = this.blankNodes.find( ( node )=> { return node.id === nodeOrId} );\n\t\t} else {\n\t\t\tnode = nodeOrId;\n\t\t}\n\t\tif( this.openedBlankNodes.indexOf( node ) === - 1 ) this.openedBlankNodes.push( node );\n\t\tsetTimeout( () => {\n\t\t\tthis.refreshTabs();\n\t\t\tthis.goToBlankNode( \"blankNode_\" + this.escape( node.id ) );\n\t\t}, 50 );\n\t}\n\n\topenNamedFragment( id:string ):void {\n\t\tthis.onOpenNamedFragment.emit( id );\n\t}\n\n\tgoToBlankNode( id:string ) {\n\t\tif( ! this.nodesTab ) return;\n\t\tthis.nodesTab.find( \"> [data-tab='\" + id + \"']\" ).click();\n\t\tthis.onOpenBNode.emit( \"bNodes\" );\n\t}\n\n\tcloseBlankNode( blankNode:BlankNodeRow, index?:number ):void {\n\t\t// if( blankNode.added ) {\n\t\t// \tthis.deleteBlankNode( blankNode, index );\n\t\t// \tdelete blankNode.added;\n\t\t// } else {\n\t\t// \tdelete blankNode.modified;\n\t\t// \tthis.changeBlankNode( blankNode );\n\t\t// }\n\t\tthis.openedBlankNodes.splice( index, 1 );\n\t\tthis.goToBlankNode( \"all\" );\n\t}\n\n\trefreshTabs():void {\n\t\tthis.nodesTab.find( \">.item\" ).tab();\n\t}\n\n\tescape( value:string ):string {\n\t\treturn value === \"all\" ? value : value.substr( value.indexOf( \"_:\" ) + 2 );\n\t}\n\n\t// Here comes the CRUD of blank nodes\n\tchangeBlankNode( blankNodeRow:BlankNodeRow, index?:number ):void {\n\t\tif( typeof this.blankNodesRecords === \"undefined\" ) this.blankNodesRecords = new BlankNodesRecords();\n\t\tif( typeof blankNodeRow.modified !== \"undefined\" ) {\n\t\t\tthis.blankNodesRecords.changes.set( blankNodeRow.modified[ \"@id\" ], blankNodeRow );\n\t\t} else if( typeof blankNodeRow.added === \"undefined\" ) {\n\t\t\tthis.blankNodesRecords.changes.delete( blankNodeRow.copy[ \"@id\" ] );\n\t\t}\n\t\tthis.onChanges.emit( this.blankNodesRecords );\n\t}\n\n\tdeleteBlankNode( blankNodeRow:BlankNodeRow, index?:number ):void {\n\t\tif( typeof this.blankNodesRecords === \"undefined\" ) this.blankNodesRecords = new BlankNodesRecords();\n\t\tif( typeof blankNodeRow.added !== \"undefined\" ) {\n\t\t\tthis.blankNodesRecords.additions.delete( blankNodeRow.added[ \"@id\" ] );\n\t\t} else if( typeof blankNodeRow.modified !== \"undefined\" ) {\n\t\t\tthis.blankNodesRecords.changes.delete( blankNodeRow.modified[ \"@id\" ] );\n\t\t\tthis.blankNodesRecords.deletions.set( blankNodeRow.modified[ \"@id\" ], blankNodeRow );\n\t\t} else {\n\t\t\t// this.blankNodesRecords.changes.delete( blankNodeRow.modified[ \"@id\" ] );\n\t\t\tthis.blankNodesRecords.deletions.set( blankNodeRow.copy[ \"@id\" ], blankNodeRow );\n\t\t}\n\t\tindex = this.blankNodes.indexOf( blankNodeRow );\n\t\tthis.blankNodes.splice( index, 1 );\n\t\tthis.onChanges.emit( this.blankNodesRecords );\n\t}\n\n\tcreateBlankNode():void {\n\t\tlet id:string = \"_:\" + this.generateUUID(),\n\t\t\tbNodeIdentifier:string = this.generateUUID();\n\t\tlet newBlankNode:BlankNodeRow = <BlankNodeRow>{\n\t\t\tid: id,\n\t\t\tbNodeIdentifier: bNodeIdentifier,\n\t\t\tadded: {\n\t\t\t\t\"@id\": id,\n\t\t\t\t\"https://carbonldp.com/ns/v1/platform#bNodeIdentifier\": [ { \"@value\": bNodeIdentifier } ],\n\t\t\t}\n\t\t};\n\t\tthis.blankNodes.splice( 0, 0, newBlankNode );\n\t\tthis.blankNodesRecords.additions.set( id, newBlankNode );\n\t\tthis.onChanges.emit( this.blankNodesRecords );\n\t\tthis.openBlankNode( id );\n\t}\n\n\tgenerateUUID():string {\n\t\treturn Utils.UUID.generate();\n\t}\n\n\tinitializeDeletionDimmer():void {\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( { closable: false } );\n\t}\n\n\taskToConfirmDeletion( clickEvent:Event, blankNode:BlankNodeRow ):void {\n\t\tclickEvent.stopPropagation();\n\t\tthis.askingDeletionBlankNode = blankNode;\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( \"show\" );\n\t}\n\n\tconfirmDeletion():void {\n\t\tthis.deleteBlankNode( this.askingDeletionBlankNode );\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( \"hide\" );\n\t}\n\n\tcancelDeletion():void {\n\t\tthis.askingDeletionBlankNode = null;\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( \"hide\" );\n\t}\n\n}\n\nexport class BlankNodesRecords {\n\tchanges:Map<string,BlankNodeRow> = new Map<string, BlankNodeRow>();\n\tdeletions:Map<string,BlankNodeRow> = new Map<string, BlankNodeRow>();\n\tadditions:Map<string,BlankNodeRow> = new Map<string, BlankNodeRow>();\n\n\tclear():void {\n\t\tthis.changes.clear();\n\t\tthis.deletions.clear();\n\t\tthis.additions.clear();\n\t}\n}\n\nexport default BlankNodesComponent;"],"sourceRoot":"/source/"}