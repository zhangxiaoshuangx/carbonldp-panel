{"version":3,"sources":["my-apps/app-content/explorer/document-explorer/named-fragments/named-fragments.component.ts"],"names":[],"mappings":"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","file":"my-apps/app-content/explorer/document-explorer/named-fragments/named-fragments.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, EventEmitter, SimpleChange, OnChanges, AfterViewInit } from \"@angular/core\";\n\nimport * as URI from \"carbonldp/RDF/URI\";\n\nimport { NamedFragmentComponent, NamedFragmentRow } from \"./named-fragment.component\";\nimport { BlankNodeRow } from \"./../blank-nodes/blank-node.component\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport template from \"./named-fragments.component.html!\";\nimport style from \"./named-fragments.component.css!text\";\n\n@Component( {\n\tselector: \"cp-named-fragments\",\n\ttemplate: template,\n\tstyles: [ style ],\n\tdirectives: [ NamedFragmentComponent ],\n} )\n\nexport class NamedFragmentsComponent implements AfterViewInit, OnChanges {\n\n\telement:ElementRef;\n\t$element:JQuery;\n\n\tnodesTab:JQuery;\n\topenedNamedFragments:NamedFragmentRow[] = [];\n\tnamedFragmentsRecords:NamedFragmentsRecords = new NamedFragmentsRecords();\n\taskingDeletionNamedFragment:NamedFragmentRow;\n\n\t@Input() blankNodes:BlankNodeRow[] = [];\n\t@Input() namedFragments:NamedFragmentRow[] = [];\n\t@Input() documentURI:string = \"\";\n\n\t@Output() onChanges:EventEmitter<NamedFragmentsRecords> = new EventEmitter<NamedFragmentsRecords>();\n\t@Output() onOpenBlankNode:EventEmitter<string> = new EventEmitter<string>();\n\t@Output() onOpenNamedFragment:EventEmitter<string> = new EventEmitter<string>();\n\n\tconstructor( element:ElementRef ) {\n\t\tthis.element = element;\n\t}\n\n\tngAfterViewInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.nodesTab = this.$element.find( \".tabular.named-fragments.menu\" );\n\t\tthis.initializeDeletionDimmer();\n\t}\n\n\tngOnChanges( changes:{[propName:string]:SimpleChange} ):void {\n\t\tif( ( changes[ \"namedFragments\" ].currentValue !== changes[ \"namedFragments\" ].previousValue ) ) {\n\t\t\tthis.openedNamedFragments = [];\n\t\t\tthis.goToNamedFragment( \"all-namedFragments\" );\n\t\t\tthis.namedFragmentsRecords.clear();\n\t\t}\n\t}\n\n\topenNamedFragment( nodeOrId:NamedFragmentRow|string ):void {\n\t\tlet node:NamedFragmentRow;\n\t\tif( typeof nodeOrId === \"string\" ) {\n\t\t\tnode = this.namedFragments.find( ( node )=> { return node.name === nodeOrId} );\n\t\t} else {\n\t\t\tnode = nodeOrId;\n\t\t}\n\t\tif( this.openedNamedFragments.indexOf( node ) === - 1 )this.openedNamedFragments.push( node );\n\t\tsetTimeout( () => {\n\t\t\tthis.refreshTabs();\n\t\t\tthis.goToNamedFragment( \"named-fragment_\" + this.getNormalizedUri( node.name ) );\n\t\t}, 50 );\n\t}\n\n\topenBlankNode( id:string ):void {\n\t\tthis.onOpenBlankNode.emit( id );\n\t}\n\n\tgoToNamedFragment( id:string ) {\n\t\tif( ! this.nodesTab )\n\t\t\treturn;\n\t\tthis.nodesTab.find( \"> [data-tab='\" + id + \"']\" ).click();\n\t\tthis.onOpenNamedFragment.emit( \"namedFragments\" );\n\t}\n\n\tcloseNamedFragment( namedFragment:NamedFragmentRow, index?:number ):void {\n\t\tthis.openedNamedFragments.splice( index, 1 );\n\t\tthis.goToNamedFragment( \"all-namedFragments\" );\n\t}\n\n\trefreshTabs():void {\n\t\tlet items:JQuery = this.nodesTab.find( \">.item\" );\n\t\titems.removeData();\n\t\t// The destroy is because JQuery uses a cache version of all data attributes. So we need to clear the data attributes to get the new tabs ids.\n\t\titems.tab( \"destroy\" );\n\t\titems.tab();\n\t}\n\n\tgetNormalizedUri( uri:string ):string {\n\t\treturn uri.replace( /[^\\w\\s]/gi, \"\" );\n\t}\n\n\tgetSlug( uri:string ) {\n\t\treturn URI.Util.getSlug( uri );\n\t}\n\n\tchangeNamedFragment( namedFragmentRow:NamedFragmentRow, index?:number ):void {\n\t\tif( typeof this.namedFragmentsRecords === \"undefined\" ) this.namedFragmentsRecords = new NamedFragmentsRecords();\n\t\tif( typeof namedFragmentRow.modified !== \"undefined\" ) {\n\t\t\tthis.namedFragmentsRecords.changes.set( namedFragmentRow.id, namedFragmentRow );\n\t\t} else if( typeof namedFragmentRow.added === \"undefined\" ) {\n\t\t\tthis.namedFragmentsRecords.changes.delete( namedFragmentRow.id );\n\t\t}\n\t\tthis.refreshTabs();\n\t\tthis.onChanges.emit( this.namedFragmentsRecords );\n\t}\n\n\tdeleteNamedFragment( namedFragmentRow:NamedFragmentRow, index?:number ):void {\n\t\tif( typeof this.namedFragmentsRecords === \"undefined\" ) this.namedFragmentsRecords = new NamedFragmentsRecords();\n\t\tif( typeof namedFragmentRow.added !== \"undefined\" ) {\n\t\t\tthis.namedFragmentsRecords.additions.delete( namedFragmentRow.id );\n\t\t} else if( typeof namedFragmentRow.modified !== \"undefined\" ) {\n\t\t\tthis.namedFragmentsRecords.changes.delete( namedFragmentRow.id );\n\t\t\tthis.namedFragmentsRecords.deletions.set( namedFragmentRow.id, namedFragmentRow );\n\t\t} else {\n\t\t\tthis.namedFragmentsRecords.deletions.set( namedFragmentRow.id, namedFragmentRow );\n\t\t}\n\t\tindex = this.namedFragments.indexOf( namedFragmentRow );\n\t\tthis.namedFragments.splice( index, 1 );\n\t\tthis.refreshTabs();\n\t\tthis.onChanges.emit( this.namedFragmentsRecords );\n\t}\n\n\tcreateNamedFragment():void {\n\t\tlet newName:string = this.documentURI + \"#New-Fragment-Name-\";\n\t\tlet newFragments:NamedFragmentRow[] = this.namedFragments.filter( ( namedFragment:NamedFragmentRow ) => { return namedFragment.name.startsWith( newName ) } );\n\t\tlet id:string = newName + (newFragments.length + 1);\n\t\tlet newNamedFragment:NamedFragmentRow = <NamedFragmentRow>{\n\t\t\tid: id,\n\t\t\tname: id,\n\t\t\tcopy: {\n\t\t\t\t\"@id\": id\n\t\t\t}\n\t\t};\n\t\tnewNamedFragment.added = newNamedFragment.copy;\n\t\tthis.namedFragments.splice( 0, 0, newNamedFragment );\n\t\tthis.namedFragmentsRecords.additions.set( id, newNamedFragment );\n\t\tthis.refreshTabs();\n\t\tthis.onChanges.emit( this.namedFragmentsRecords );\n\t\tthis.openNamedFragment( id );\n\t}\n\n\tinitializeDeletionDimmer():void {\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( { closable: false } );\n\t}\n\n\taskToConfirmDeletion( clickEvent:Event, blankNode:BlankNodeRow ):void {\n\t\tclickEvent.stopPropagation();\n\t\tthis.askingDeletionNamedFragment = blankNode;\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( \"show\" );\n\t}\n\n\tconfirmDeletion():void {\n\t\tthis.deleteNamedFragment( this.askingDeletionNamedFragment );\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( \"hide\" );\n\t}\n\n\tcancelDeletion():void {\n\t\tthis.askingDeletionNamedFragment = null;\n\t\tthis.$element.find( \".confirm-deletion.dimmer\" ).dimmer( \"hide\" );\n\t}\n\n}\n\nexport class NamedFragmentsRecords {\n\tchanges:Map<string,NamedFragmentRow> = new Map<string, NamedFragmentRow>();\n\tdeletions:Map<string,NamedFragmentRow> = new Map<string, NamedFragmentRow>();\n\tadditions:Map<string,NamedFragmentRow> = new Map<string, NamedFragmentRow>();\n\n\tclear():void {\n\t\tthis.changes.clear();\n\t\tthis.deletions.clear();\n\t\tthis.additions.clear();\n\t}\n}\nexport default NamedFragmentsComponent;"],"sourceRoot":"/source/"}