{"version":3,"sources":["my-apps/app-content/security/agents/agent.resolver.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAA2B,eAAe,CAAC,CAAA;AAC3C,uBAAyB,iBAAiB,CAAC,CAAA;AAC3C,uBAAwE,iBAAiB,CAAC,CAAA;AAI1F,+BAA8B,kBAAkB,CAAC,CAAA;AACjD,oCAAkC,yDAAyD,CAAC,CAAA;AAG5F;IAQC,uBAAa,MAAa,EAAE,KAAoB,EAAE,aAA2B,EAAE,iBAAmC,EAAU,QAAiB;QAAjB,aAAQ,GAAR,QAAQ,CAAS;QAC5I,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACnC,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;IAC5C,CAAC;IAGD,yJAAyJ;IACzJ,+BAAO,GAAP,UAAS,KAA4B;QAArC,iBAWC;QAVA,IAAI,IAAI,GAAU,KAAK,CAAC,MAAM,CAAE,YAAY,CAAE,CAAC;QAC/C,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAE,IAAI,EAAE,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,OAAO,CAAE,CAAC,IAAI,CAAE,UAAE,KAA0B;YACjH,MAAM,CAAC,KAAK,CAAC;QACd,CAAC,CAAE,CAAC,KAAK,CAAE,UAAE,KAAS;YACrB,IAAI,GAAG,GAAU,KAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,EACpC,YAAY,GAAU,GAAG,CAAC,WAAW,CAAE,GAAG,CAAE,EAC5C,QAAQ,GAAU,GAAG,CAAC,MAAM,CAAE,CAAC,EAAE,YAAY,CAAE,GAAG,kBAAkB,CAAC;YACtE,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAE,CAAE,QAAQ,CAAE,CAAE,CAAC;YACrC,MAAM,CAAC,KAAK,CAAC;QACd,CAAC,CAAE,CAAC;IACL,CAAC;IA7BF;QAAC,iBAAU,EAAE;;qBAAA;IA8Bb,oBAAC;AAAD,CA7BA,AA6BC,IAAA;AA7BY,qBAAa,gBA6BzB,CAAA","file":"agent.resolver.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { Location } from '@angular/common';\nimport { Router, Resolve, ActivatedRoute, ActivatedRouteSnapshot } from '@angular/router';\n\nimport * as PersistedAgent from \"carbonldp/Auth/PersistedAgent\";\n\nimport { AgentsService } from \"./agents.service\";\nimport { AppContentService } from \"carbonldp-panel/my-apps/app-content/app-content.service\";\n\n@Injectable()\nexport class AgentResolver implements Resolve<PersistedAgent.Class> {\n\n\tprivate router:Router;\n\tprivate activatedRoute:ActivatedRoute;\n\tprivate agentsService:AgentsService;\n\tprivate appContentService:AppContentService;\n\n\n\tconstructor( router:Router, route:ActivatedRoute, agentsService:AgentsService, appContentService:AppContentService, private location:Location ) {\n\t\tthis.router = router;\n\t\tthis.activatedRoute = route;\n\t\tthis.agentsService = agentsService;\n\t\tthis.appContentService = appContentService;\n\t}\n\n\n\t// TODO: Change the use of location to the righ way of navigate with an activatedRoute, check if this 'bug' has been resolved on further angular versions\n\tresolve( route:ActivatedRouteSnapshot ):Promise<PersistedAgent.Class> | PersistedAgent.Class {\n\t\tlet slug:string = route.params[ \"agent-slug\" ];\n\t\treturn this.agentsService.get( slug, this.appContentService.activeApp.context ).then( ( agent:PersistedAgent.Class ) => {\n\t\t\treturn agent;\n\t\t} ).catch( ( error:any ):boolean => {\n\t\t\tlet url:string = this.location.path(),\n\t\t\t\tlastSlashIdx:number = url.lastIndexOf( \"/\" ),\n\t\t\t\tfinalURL:string = url.substr( 0, lastSlashIdx ) + \"/agent-not-found\";\n\t\t\tthis.router.navigate( [ finalURL ] );\n\t\t\treturn false;\n\t\t} );\n\t}\n}"]}