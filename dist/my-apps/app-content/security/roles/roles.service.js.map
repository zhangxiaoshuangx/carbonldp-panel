{"version":3,"sources":["my-apps/app-content/security/roles/roles.service.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,qBAA2B,eAAe,CAAC,CAAA;AAE3C,uBAAmB,kBAAkB,CAAC,CAAA;AAEtC,IAAY,KAAK,WAAM,sBAAsB,CAAC,CAAA;AAG9C,IAAY,KAAK,WAAM,iBAAiB,CAAC,CAAA;AAGzC;IAKC,sBAAa,MAAa;QACzB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,gBAAgB,GAAG,IAAI,GAAG,EAA4C,CAAC;IAC7E,CAAC;IAED,6BAAM,GAAN,UAAQ,UAAsB;QAC7B,IAAI,GAAG,GAAU,UAAU,CAAC,UAAU,EAAE,GAAG,QAAQ,CAAC;QACpD,IAAI,aAAa,GAAqC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAE,UAAU,CAAC,UAAU,EAAE,CAAE,CAAC;QAC3G,aAAa,GAAG,OAAO,aAAa,KAAK,WAAW,GAAG,IAAI,GAAG,EAA+B,GAAG,aAAa,CAAC;QAC9G,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAuB,GAAG,CAAE,CAAC,IAAI,CAAE,UAAE,EAAkE;gBAAhE,aAAK,EAAE,gBAAQ;YAC7F,KAAK,CAAC,MAAM,CAAE,UAAE,IAAwB,IAAM,OAAA,CAAE,aAAa,CAAC,GAAG,CAAE,IAAI,CAAC,EAAE,CAAE,EAA9B,CAA8B,CAAE;iBAC5E,OAAO,CAAE,UAAE,IAAwB,IAAM,OAAA,aAAa,CAAC,GAAG,CAAE,IAAI,CAAC,EAAE,EAAE,IAAI,CAAE,EAAlC,CAAkC,CAAE,CAAC;YAChF,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAE,aAAa,CAAC,MAAM,EAAE,CAAE,CAAC;QAC/C,CAAC,CAAE,CAAC;IACL,CAAC;IAED,oCAAa,GAAb,UAAe,UAAsB,EAAE,OAAc,EAAE,MAAa;QACnE;YAA0B,+BAAW;YAArC;gBAA0B,8BAAW;YAAE,CAAC;YAAD,kBAAC;QAAD,CAAvC,AAAwC,CAAd,KAAK,CAAC,KAAK,GAAG;QACxC,IAAI,KAAK,GAAe,IAAI,WAAW,CAAE,UAAU,CAAE,CAAC;QACtD,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAE,MAAM,EAAE,OAAO,CAAE,CAAA;IACzC,CAAC;IAED,kCAAW,GAAX,UAAa,UAAsB,EAAE,OAAc,EAAE,MAAa;QACjE;YAA0B,+BAAW;YAArC;gBAA0B,8BAAW;YAAE,CAAC;YAAD,kBAAC;QAAD,CAAvC,AAAwC,CAAd,KAAK,CAAC,KAAK,GAAG;QACxC,IAAI,KAAK,GAAe,IAAI,WAAW,CAAE,UAAU,CAAE,CAAC;QACtD,MAAM,CAAC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,OAAO,CAAE,CAAA;IAC5C,CAAC;IAhCF;QAAC,iBAAU,EAAE;;oBAAA;IAkCb,mBAAC;AAAD,CAjCA,AAiCC,IAAA;AAjCY,oBAAY,eAiCxB,CAAA;AAED;kBAAe,YAAY,CAAC","file":"roles.service.js","sourcesContent":["import { Injectable } from \"@angular/core\";\n\nimport Carbon from \"carbonldp/Carbon\";\nimport * as App from \"carbonldp/App\";\nimport * as Roles from \"carbonldp/Auth/Roles\";\nimport * as PersistedRole from \"carbonldp/Auth/PersistedRole\";\nimport * as HTTP from \"carbonldp/HTTP\";\nimport * as Utils from \"carbonldp/Utils\";\n\n@Injectable()\nexport class RolesService {\n\n\tcarbon:Carbon;\n\tappContextsRoles:Map<string, Map<string, PersistedRole.Class>>;\n\n\tconstructor( carbon:Carbon ) {\n\t\tthis.carbon = carbon;\n\t\tthis.appContextsRoles = new Map<string, Map<string, PersistedRole.Class>>();\n\t}\n\n\tgetAll( appContext:App.Context ):Promise<PersistedRole.Class[]> {\n\t\tlet uri:string = appContext.getBaseURI() + \"roles/\";\n\t\tlet existingRoles:Map <string, PersistedRole.Class> = this.appContextsRoles.get( appContext.getBaseURI() );\n\t\texistingRoles = typeof existingRoles === \"undefined\" ? new Map<string, PersistedRole.Class>() : existingRoles;\n\t\treturn this.carbon.documents.getChildren<PersistedRole.Class>( uri ).then( ( [ roles, response ]:[ PersistedRole.Class[], HTTP.Response.Class ] ) => {\n\t\t\troles.filter( ( role:PersistedRole.Class ) => ! existingRoles.has( role.id ) )\n\t\t\t\t.forEach( ( role:PersistedRole.Class ) => existingRoles.set( role.id, role ) );\n\t\t\treturn Utils.A.from( existingRoles.values() );\n\t\t} );\n\t}\n\n\tregisterAgent( appContext:App.Context, agentID:string, roleID:string ):Promise<HTTP.Response.Class> {\n\t\tclass MockedRoles extends Roles.Class {}\n\t\tlet roles:Roles.Class = new MockedRoles( appContext );\n\t\treturn roles.addAgent( roleID, agentID )\n\t}\n\n\tremoveAgent( appContext:App.Context, agentID:string, roleID:string ):Promise<HTTP.Response.Class> {\n\t\tclass MockedRoles extends Roles.Class {}\n\t\tlet roles:Roles.Class = new MockedRoles( appContext );\n\t\treturn roles.removeAgent( roleID, agentID )\n\t}\n\n}\n\nexport default RolesService;"]}