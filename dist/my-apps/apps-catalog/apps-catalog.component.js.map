{"version":3,"sources":["my-apps/apps-catalog/apps-catalog.component.ts"],"names":[],"mappings":"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","file":"my-apps/apps-catalog/apps-catalog.component.js","sourcesContent":["import {Component, ElementRef, Input, OnInit} from \"@angular/core\";\nimport {Router, ROUTER_DIRECTIVES} from \"@angular/router-deprecated\";\nimport {Observable} from \"rxjs/Rx\";\n\nimport Carbon from \"carbonldp/Carbon\";\nimport * as CarbonApp from \"carbonldp/App\";\nimport * as HTTP from \"carbonldp/HTTP\";\n\nimport {MyAppsSidebarService} from \"./../my-apps-sidebar.service\";\nimport {AppsTilesComponent} from \"./apps-tiles/apps-tiles.component\";\nimport {AppsListComponent} from \"./apps-list/apps-list.component\";\nimport * as App from \"./../app-content/app\";\n\nimport {Message} from \"./../../errors-area/error-message.component\";\nimport {AppContextService} from \"./../app-context.service\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport template from \"./apps-catalog.component.html!\";\n\n@Component( {\n\tselector: \"cp-apps-catalog\",\n\ttemplate: template,\n\tstyles: [ \":host { display: block; }\" ],\n\tdirectives: [ ROUTER_DIRECTIVES, AppsTilesComponent, AppsListComponent ],\n} )\nexport class AppsCatalogComponent implements OnInit {\n\t@Input() apps:App.Class[] = [];\n\tresults:App.Class[] = [];\n\n\tloading:boolean = false;\n\ttileView:boolean = false;\n\tsearchBox:JQuery;\n\terrorMessage:string = \"\";\n\twarningMessage:string = \"\";\n\taskingApp:App.Class;\n\n\tdeleteAppConfirmationModal:JQuery;\n\tdeleting:boolean = false;\n\tdeleteError:Message;\n\n\tprivate element:ElementRef;\n\tprivate $element:JQuery;\n\tprivate router:Router;\n\tprivate carbon:Carbon;\n\tprivate appContextService:AppContextService;\n\tprivate myAppsSidebarService:MyAppsSidebarService;\n\n\tconstructor( element:ElementRef, router:Router, appContextService:AppContextService, carbon:Carbon, myAppsSidebarService:MyAppsSidebarService ) {\n\t\tthis.element = element;\n\t\tthis.appContextService = appContextService;\n\t\tthis.router = router;\n\t\tthis.carbon = carbon;\n\t\tthis.myAppsSidebarService = myAppsSidebarService;\n\t}\n\n\tngOnInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.deleteAppConfirmationModal = this.$element.find( \".delete-app-confirmation.modal\" );\n\t\tthis.searchBox = this.$element.find( \"input.search\" );\n\t\tlet terms:any = Observable.fromEvent( this.searchBox, \"input\" );\n\t\tterms\n\t\t\t.debounceTime( 200 )\n\t\t\t.map( ( evt ) => {\n\t\t\t\treturn evt.target.value;\n\t\t\t} )\n\t\t\t.distinctUntilChanged()\n\t\t\t.subscribe(\n\t\t\t\t( args ):void => {\n\t\t\t\t\tthis.searchApp( args );\n\t\t\t\t}\n\t\t\t);\n\t\tthis.fetchApps();\n\t\tthis.initializeModal();\n\t}\n\n\tactivateGridView():void {\n\t\tthis.tileView = true;\n\t}\n\n\tactivateListView():void {\n\t\tthis.tileView = false;\n\t}\n\n\tsearchApp( term:string ):void {\n\t\tthis.results = this.apps.filter( ( app ) => {\n\t\t\treturn app.name.toLowerCase().search( term.toLowerCase() ) > - 1 || app.slug.toLowerCase().search( term.toLowerCase() ) > - 1\n\t\t} );\n\t\tthis.errorMessage = \"\";\n\t\tif( this.results.length === 0 && term.length > 0 ) {\n\t\t\tthis.errorMessage = \"No apps found.\";\n\t\t}\n\t}\n\n\taskConfirmationToDeleteApp( selectedApp:App.Class ):void {\n\t\tthis.askingApp = selectedApp;\n\t\tthis.toggleDeleteConfirmationModal();\n\t}\n\n\ttoggleDeleteConfirmationModal():void {\n\t\tthis.deleteAppConfirmationModal.modal( \"toggle\" );\n\t\tthis.deleteError = null;\n\t}\n\n\tonApproveAppDeletion( approvedApp:App.Class ):void {\n\t\tif( this.deleting ) return;\n\t\tthis.deleting = true;\n\t\tthis.deleteError = null;\n\t\tthis.deleteApp( approvedApp ).then( ( response:HTTP.Response.Class ):void => {\n\t\t\tthis.toggleDeleteConfirmationModal();\n\t\t\tthis.apps.splice( this.apps.indexOf( approvedApp ), 1 );\n\t\t\tthis.loadApps();\n\t\t} ).catch( ( error:HTTP.Errors.Error ):void => {\n\t\t\tthis.deleteError = this.getErrorMessage( error );\n\t\t} ).then( ():void => {\n\t\t\tthis.deleting = false;\n\t\t\tthis.searchApp( this.searchBox.val() );\n\t\t} );\n\t}\n\n\topenApp( app:App.Class ):void {\n\t\tthis.myAppsSidebarService.addApp( app );\n\t\tthis.router.navigate( [ \"App\", { slug: app.slug }, \"AppDashboard\" ] );\n\t}\n\n\tdeleteApp( app:App.Class ):Promise<HTTP.Response.Class> {\n\t\treturn app.destroy();\n\t}\n\n\tgetErrorMessage( error:HTTP.Errors.Error ):Message {\n\t\tlet content:string = \"\";\n\t\tswitch ( true ) {\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\tcontent = \"Denied Access.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\tcontent = \"No access to the requested resource(s).\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.BadGatewayError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.GatewayTimeoutError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\tcontent = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcontent = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: error.name,\n\t\t\tcontent: ! ! error.message ? error.message : content,\n\t\t\tstatusCode: \"\" + error.response.status,\n\t\t\tstatusMessage: (<XMLHttpRequest>error.response.request).statusText,\n\t\t\tendpoint: \"\",\n\t\t};\n\t}\n\n\tcloseErrorMessage( evt:any ):void {\n\t\t$( evt.srcElement ).closest( \".ui.message\" ).transition( \"fade\" );\n\t\tthis.deleteError = null;\n\t}\n\n\tinitializeModal():void {\n\t\tthis.deleteAppConfirmationModal.modal( {\n\t\t\tclosable: false,\n\t\t\tblurring: true,\n\t\t\tonApprove: ():boolean => { return false; },\n\t\t} );\n\t}\n\n\tfetchApps():void {\n\t\tthis.loading = true;\n\t\tthis.loadApps().then( ( apps:App.Class[] ):void => {\n\t\t\tthis.results = apps;\n\t\t\tthis.loading = false;\n\t\t\tif( this.apps.length === 0 ) this.warningMessage = \"There are currently no apps to show.\"\n\t\t} ).catch( ( error:any ):void => {\n\t\t\tthis.errorMessage = this.getErrorMessage( error ).content;\n\t\t\tthis.loading = false;\n\t\t} );\n\t}\n\n\tprivate loadApps():Promise< App.Class[] > {\n\t\treturn this.appContextService.getAll().then( ( appContexts:CarbonApp.Context[] ) => {\n\t\t\tthis.apps = appContexts.map( App.Factory.createFrom );\n\t\t\treturn this.apps;\n\t\t} );\n\t}\n}\n\nexport default AppsCatalogComponent;\n"],"sourceRoot":"/source/"}