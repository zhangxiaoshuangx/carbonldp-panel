{"version":3,"sources":["my-apps/apps-catalog/apps-catalog.component.ts"],"names":[],"mappings":"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","file":"apps-catalog.component.js","sourcesContent":["import { Component, ElementRef, Input, OnInit } from \"@angular/core\";\nimport { Router, ActivatedRoute } from \"@angular/router\";\nimport { Observable } from \"rxjs/Rx\";\n\nimport Carbon from \"carbonldp/Carbon\";\nimport * as CarbonApp from \"carbonldp/App\";\nimport * as HTTP from \"carbonldp/HTTP\";\n\nimport { MyAppsSidebarService } from \"./../my-apps-sidebar.service\";\n\nimport * as App from \"./../app-content/app\";\n\nimport { Message } from \"./../../errors-area/error-message.component\";\nimport { AppContextService } from \"./../app-context.service\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport template from \"./apps-catalog.component.html!\";\n\n@Component( {\n\tselector: \"cp-apps-catalog\",\n\ttemplate: template,\n\tstyles: [ \":host { display: block; }\" ],\n} )\nexport class AppsCatalogComponent implements OnInit {\n\t@Input() apps:App.Class[] = [];\n\tresults:App.Class[] = [];\n\n\tloading:boolean = false;\n\ttileView:boolean = false;\n\tsearchBox:JQuery;\n\terrorMessage:string = \"\";\n\twarningMessage:string = \"\";\n\taskingApp:App.Class;\n\n\tdeleteAppConfirmationModal:JQuery;\n\tdeleting:boolean = false;\n\tdeleteError:Message;\n\n\tprivate element:ElementRef;\n\tprivate $element:JQuery;\n\tprivate router:Router;\n\tprivate route:ActivatedRoute;\n\tprivate carbon:Carbon;\n\tprivate appContextService:AppContextService;\n\tprivate myAppsSidebarService:MyAppsSidebarService;\n\n\tconstructor( element:ElementRef, router:Router, route:ActivatedRoute, appContextService:AppContextService, carbon:Carbon, myAppsSidebarService:MyAppsSidebarService ) {\n\t\tthis.element = element;\n\t\tthis.appContextService = appContextService;\n\t\tthis.router = router;\n\t\tthis.route = route;\n\t\tthis.carbon = carbon;\n\t\tthis.myAppsSidebarService = myAppsSidebarService;\n\t}\n\n\tngOnInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.deleteAppConfirmationModal = this.$element.find( \".delete-app-confirmation.modal\" );\n\t\tthis.searchBox = this.$element.find( \"input.search\" );\n\t\tlet terms:any = Observable.fromEvent( this.searchBox, \"input\" );\n\t\tterms\n\t\t\t.debounceTime( 200 )\n\t\t\t.map( ( evt ) => {\n\t\t\t\treturn evt.target.value;\n\t\t\t} )\n\t\t\t.distinctUntilChanged()\n\t\t\t.subscribe(\n\t\t\t\t( args ):void => {\n\t\t\t\t\tthis.searchApp( args );\n\t\t\t\t}\n\t\t\t);\n\t\tthis.fetchApps();\n\t\tthis.initializeModal();\n\t\tthis.myAppsSidebarService.init();\n\t}\n\n\tactivateGridView():void {\n\t\tthis.tileView = true;\n\t}\n\n\tactivateListView():void {\n\t\tthis.tileView = false;\n\t}\n\n\tsearchApp( term:string ):void {\n\t\tthis.results = this.apps.filter( ( app ) => {\n\t\t\treturn app.name.toLowerCase().search( term.toLowerCase() ) > - 1 || app.slug.toLowerCase().search( term.toLowerCase() ) > - 1\n\t\t} );\n\t\tthis.errorMessage = \"\";\n\t\tif( this.results.length === 0 && term.length > 0 ) {\n\t\t\tthis.errorMessage = \"No apps found.\";\n\t\t}\n\t}\n\n\taskConfirmationToDeleteApp( selectedApp:App.Class ):void {\n\t\tthis.askingApp = selectedApp;\n\t\tthis.toggleDeleteConfirmationModal();\n\t}\n\n\ttoggleDeleteConfirmationModal():void {\n\t\tthis.deleteAppConfirmationModal.modal( \"toggle\" );\n\t\tthis.deleteError = null;\n\t}\n\n\tonApproveAppDeletion( approvedApp:App.Class ):void {\n\t\tif( this.deleting ) return;\n\t\tthis.deleting = true;\n\t\tthis.deleteError = null;\n\t\tthis.deleteApp( approvedApp ).then( ( response:HTTP.Response.Class ):void => {\n\t\t\tthis.toggleDeleteConfirmationModal();\n\t\t\tthis.apps.splice( this.apps.indexOf( approvedApp ), 1 );\n\t\t\tthis.loadApps();\n\t\t} ).catch( ( error:HTTP.Errors.Error ):void => {\n\t\t\tthis.deleteError = this.getErrorMessage( error );\n\t\t} ).then( ():void => {\n\t\t\tthis.deleting = false;\n\t\t\tthis.searchApp( this.searchBox.val() );\n\t\t} );\n\t}\n\n\topenApp( app:App.Class ):void {\n\t\tthis.myAppsSidebarService.addApp( app );\n\t\tthis.myAppsSidebarService.openApp( app );\n\t\tthis.router.navigate( [ app.slug ], { relativeTo: this.route } );\n\t}\n\n\tdeleteApp( app:App.Class ):Promise<HTTP.Response.Class> {\n\t\treturn app.delete();\n\t}\n\n\tgetErrorMessage( error:HTTP.Errors.Error ):Message {\n\t\tlet content:string = \"\";\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\tcontent = \"Denied Access.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\tcontent = \"No access to the requested resource(s).\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.BadGatewayError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.GatewayTimeoutError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\tcontent = \"An error occurred while trying to fetch apps. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\tcontent = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcontent = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: error.name,\n\t\t\tcontent: ! ! error.message ? error.message : content,\n\t\t\tstatusCode: \"\" + error.response.status,\n\t\t\tstatusMessage: (<XMLHttpRequest>error.response.request).statusText,\n\t\t\tendpoint: \"\",\n\t\t};\n\t}\n\n\tcloseErrorMessage( evt:any ):void {\n\t\t$( evt.srcElement ).closest( \".ui.message\" ).transition( \"fade\" );\n\t\tthis.deleteError = null;\n\t}\n\n\tinitializeModal():void {\n\t\tthis.deleteAppConfirmationModal.modal( {\n\t\t\tclosable: false,\n\t\t\tblurring: true,\n\t\t\tonApprove: ():boolean => { return false; },\n\t\t} );\n\t}\n\n\trefreshApps():void {\n\t\tthis.fetchApps();\n\t}\n\n\tfetchApps():void {\n\t\tthis.loading = true;\n\t\tthis.loadApps().then( ( apps:App.Class[] ):void => {\n\t\t\tthis.results = apps;\n\t\t\tthis.loading = false;\n\t\t\tif( this.apps.length === 0 ) this.warningMessage = \"There are currently no apps to show.\"\n\t\t} ).catch( ( error:any ):void => {\n\t\t\tthis.errorMessage = this.getErrorMessage( error ).content;\n\t\t\tthis.loading = false;\n\t\t} );\n\t}\n\n\tprivate loadApps():Promise< App.Class[] > {\n\t\treturn this.appContextService.getAll().then( ( appContexts:CarbonApp.Context[] ) => {\n\t\t\tthis.apps = appContexts.map( App.Factory.createFrom );\n\t\t\treturn this.apps;\n\t\t} );\n\t}\n}\n\nexport default AppsCatalogComponent;\n"]}