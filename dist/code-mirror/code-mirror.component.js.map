{"version":3,"sources":["code-mirror/code-mirror.component.ts"],"names":[],"mappings":"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","file":"code-mirror/code-mirror.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, SimpleChange, EventEmitter, AfterContentInit, OnChanges, OnDestroy } from \"@angular/core\";\n\nimport CodeMirror from \"codemirror\";\n\nimport \"codemirror/mode/css/css\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/javascript/javascript\";\nimport \"codemirror/mode/sparql/sparql\";\nimport \"codemirror/mode/xml/xml\";\nimport \"codemirror/mode/turtle/turtle\";\n\nimport \"codemirror/lib/codemirror.css!\";\nimport \"codemirror/theme/mbo.css!\";\n\nimport style from \"./code-mirror.component.css!text\";\n\n@Component( {\n\tselector: \"cp-code-mirror\",\n\ttemplate: \"<ng-content></ng-content>\",\n\tstyles: [ style ],\n} )\nexport class Class implements AfterContentInit, OnChanges, OnDestroy {\n\telement:ElementRef;\n\n\t@Input() mode:string = Mode.JAVASCRIPT;\n\t@Input() readOnly:boolean = false;\n\t@Input() noCursor:boolean = false;\n\t@Input() showLineNumbers:boolean = true;\n\t@Input() scroll:boolean = true;\n\n\t@Input() value:string = \"\";\n\t@Output() valueChange:EventEmitter<string> = new EventEmitter<string>();\n\n\t@Input() codeMirror:CodeMirror.Editor;\n\t@Output() codeMirrorChange:EventEmitter<CodeMirror.Editor> = new EventEmitter<CodeMirror.Editor>();\n\n\tprivate internallyChanged:boolean = false;\n\tprivate lastUpdates:string[] = [];\n\n\tconstructor( element:ElementRef ) {\n\t\tthis.element = element;\n\t}\n\n\tngOnDestroy() {\n\t\tthis.element.nativeElement.innerHTML = this.codeMirror.getValue();\n\t}\n\n\tngAfterContentInit():void {\n\t\tif( ! this.value ) this.value = this.element.nativeElement.innerHTML;\n\t\tif( ! ! this.value ) this.value = this.normalizeTabs( this.value );\n\t\telse this.value = \"\";\n\n\t\tthis.element.nativeElement.innerHTML = \"\";\n\t\tthis.codeMirror = CodeMirror( this.element.nativeElement, {\n\t\t\tlineNumbers: this.showLineNumbers,\n\t\t\tindentWithTabs: true,\n\t\t\tsmartIndent: false,\n\t\t\telectricChars: false,\n\t\t\tmode: this.mode,\n\t\t\ttheme: \"mbo\",\n\t\t\tvalue: this.value,\n\t\t\treadOnly: this.readOnly\n\t\t} );\n\t\tthis.codeMirrorChange.emit( this.codeMirror );\n\n\t\tif( ! this.scroll ) {\n\t\t\tthis.element.nativeElement.children[ 0 ].style.height = \"auto\";\n\t\t}\n\n\t\tthis.codeMirror.on( \"change\", ( changeObject ) => {\n\t\t\tif( this.internallyChanged ) {\n\t\t\t\tthis.internallyChanged = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet lastUpdate:string = this.codeMirror.getValue();\n\t\t\tif( lastUpdate === this.value ) return;\n\n\t\t\tthis.value = lastUpdate;\n\t\t\tthis.lastUpdates.push( lastUpdate );\n\t\t\tthis.valueChange.emit( lastUpdate );\n\t\t} );\n\t}\n\n\tngOnChanges( changeRecord:any ):void {\n\t\tif( ! this.codeMirror ) return;\n\n\t\tif( \"readOnly\" in changeRecord ) {\n\t\t\tlet change:SimpleChange = changeRecord.readOnly;\n\t\t\tthis.setReadOnly( change.currentValue );\n\t\t}\n\n\t\tif( \"noCursor\" in changeRecord ) {\n\t\t\tlet change:SimpleChange = changeRecord.noCursor;\n\t\t\tthis.setNoCursor( change.currentValue );\n\t\t}\n\n\t\tif( \"value\" in changeRecord ) {\n\t\t\tif( this.lastUpdates.length > 0 && this.lastUpdates[ 0 ] === changeRecord.value.currentValue ) {\n\t\t\t\tthis.lastUpdates.shift();\n\t\t\t} else {\n\t\t\t\tthis.internallyChanged = true;\n\t\t\t\tthis.lastUpdates = [];\n\t\t\t\tthis.codeMirror.setValue( changeRecord.value.currentValue );\n\t\t\t}\n\t\t}\n\n\t}\n\n\tprivate normalizeTabs( value:string ):string {\n\t\tlet lines:string[] = value.split( /\\n/gm );\n\n\t\tif( ! lines[ 0 ].trim() ) lines.shift();\n\t\tif( ! lines[ lines.length - 1 ].trim() ) lines.pop();\n\n\t\tlet containsSomething:boolean = lines.reduce( ( previous, line ) => previous || ! ! line.trim(), false );\n\t\tif( ! containsSomething ) return \"\";\n\n\t\tlet tabs:boolean = null;\n\t\tlet extraIndentation:number = null;\n\t\tfor( let line of lines ) {\n\t\t\tif( ! line.trim() ) continue;\n\t\t\tif( tabs === null ) tabs = line.startsWith( \"\\t\" );\n\t\t\tlet indentation:number = this.getIndentation( line, tabs );\n\t\t\tif( extraIndentation === null || extraIndentation > indentation ) extraIndentation = indentation;\n\t\t}\n\n\t\tthis.removeIndentation( lines, extraIndentation, tabs );\n\n\t\treturn lines.length ? lines.join( \"\\n\" ) : \"\";\n\t}\n\n\tprivate getIndentation( line:string, tabs:boolean = true ):number {\n\t\tlet indentationChar:string = tabs ? \"\\t\" : \" \";\n\t\tfor( var i:number = 0, length = line.length; i < length; i ++ ) {\n\t\t\tif( line.charAt( i ) !== indentationChar ) break;\n\t\t}\n\t\treturn i;\n\t}\n\n\tprivate removeIndentation( lines:string[], indentation:number, tabs:boolean = true ):string[] {\n\t\tfor( let i:number = 0, length = lines.length; i < length; i ++ ) {\n\t\t\tlet line:string = lines[ i ];\n\t\t\tif( ! line.trim() ) continue;\n\t\t\tlines[ i ] = line.substring( indentation );\n\t\t}\n\t\treturn lines;\n\t}\n\n\tprivate setReadOnly( readOnly:boolean ):void {\n\t\tthis.codeMirror.setOption( \"readOnly\", readOnly );\n\t}\n\n\tprivate setNoCursor( noCursor:boolean ):void {\n\t\tif( noCursor ) this.codeMirror.setOption( \"readOnly\", \"nocursor\" );\n\t\telse this.setReadOnly( this.readOnly );\n\t}\n}\n\n\nexport class Mode {\n\tstatic get CSS():string { return \"text/css\"; };\n\n\tstatic get JAVASCRIPT():string { return \"text/javascript\"; }\n\n\tstatic get JSONLD():string { return \"application/ld+json\"; }\n\n\tstatic get JSONDRDF():string { return \"application/json\"; }\n\n\tstatic get N3():string { return \"text/turtle\"; }\n\n\tstatic get RDFXML():string { return \"application/xml\"; }\n\n\tstatic get CSV():string { return \"text/plain\"; }\n\n\tstatic get TSV():string { return \"text/plain\"; }\n\n\tstatic get SPARQL():string { return \"application/sparql-query\"; }\n\n\tstatic get XML():string { return \"application/xml\"; }\n\n\tstatic get TURTLE():string { return \"text/turtle\"; }\n}\n\nexport default Class;"],"sourceRoot":"/source/"}