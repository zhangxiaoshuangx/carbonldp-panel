{"version":3,"sources":["code-mirror/code-mirror.component.ts"],"names":[],"mappings":"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","file":"code-mirror.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, SimpleChange, EventEmitter, AfterContentInit, OnChanges, OnDestroy } from \"@angular/core\";\n\nimport CodeMirror from \"codemirror\";\n\nimport \"codemirror/mode/css/css\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/javascript/javascript\";\nimport \"codemirror/mode/sparql/sparql\";\nimport \"codemirror/mode/xml/xml\";\nimport \"codemirror/mode/turtle/turtle\";\n\n// import \"codemirror/lib/codemirror.css\";\n// import \"codemirror/theme/mbo.css\";\n\n@Component( {\n\tselector: \"cp-code-mirror\",\n\ttemplate: \"<ng-content></ng-content>\",\n\tstyles: [ require( \"./code-mirror.component.css\" ) ],\n} )\nexport class Class implements AfterContentInit, OnChanges, OnDestroy {\n\telement:ElementRef;\n\n\t@Input() mode:string = Mode.JAVASCRIPT;\n\t@Input() readOnly:boolean = false;\n\t@Input() noCursor:boolean = false;\n\t@Input() showLineNumbers:boolean = true;\n\t@Input() scroll:boolean = true;\n\n\t@Input() value:string = \"\";\n\t@Output() valueChange:EventEmitter<string> = new EventEmitter<string>();\n\n\t@Input() codeMirror:CodeMirror.Editor;\n\t@Output() codeMirrorChange:EventEmitter<CodeMirror.Editor> = new EventEmitter<CodeMirror.Editor>();\n\n\tprivate internallyChanged:boolean = false;\n\tprivate lastUpdates:string[] = [];\n\n\tconstructor( element:ElementRef ) {\n\t\tthis.element = element;\n\t}\n\n\tngOnDestroy() {\n\t\tthis.element.nativeElement.innerHTML = this.codeMirror.getValue();\n\t}\n\n\tngAfterContentInit():void {\n\t\tif( ! this.value ) this.value = this.element.nativeElement.innerHTML;\n\t\tif( ! ! this.value ) this.value = this.normalizeTabs( this.value );\n\t\telse this.value = \"\";\n\n\t\tthis.element.nativeElement.innerHTML = \"\";\n\t\tthis.codeMirror = CodeMirror( this.element.nativeElement, {\n\t\t\tlineNumbers: this.showLineNumbers,\n\t\t\tindentWithTabs: true,\n\t\t\tsmartIndent: false,\n\t\t\telectricChars: false,\n\t\t\tmode: this.mode,\n\t\t\ttheme: \"mbo\",\n\t\t\tvalue: this.value,\n\t\t\treadOnly: this.readOnly\n\t\t} );\n\t\tthis.codeMirrorChange.emit( this.codeMirror );\n\n\t\tif( ! this.scroll ) {\n\t\t\tthis.element.nativeElement.children[ 0 ].style.height = \"auto\";\n\t\t}\n\n\t\tthis.codeMirror.on( \"change\", ( changeObject ) => {\n\t\t\tif( this.internallyChanged ) {\n\t\t\t\tthis.internallyChanged = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet lastUpdate:string = this.codeMirror.getValue();\n\t\t\tif( lastUpdate === this.value ) return;\n\n\t\t\tthis.value = lastUpdate;\n\t\t\tthis.lastUpdates.push( lastUpdate );\n\t\t\tthis.valueChange.emit( lastUpdate );\n\t\t} );\n\t}\n\n\tngOnChanges( changeRecord:any ):void {\n\t\tif( ! this.codeMirror ) return;\n\n\t\tif( \"readOnly\" in changeRecord ) {\n\t\t\tlet change:SimpleChange = changeRecord.readOnly;\n\t\t\tthis.setReadOnly( change.currentValue );\n\t\t}\n\n\t\tif( \"noCursor\" in changeRecord ) {\n\t\t\tlet change:SimpleChange = changeRecord.noCursor;\n\t\t\tthis.setNoCursor( change.currentValue );\n\t\t}\n\n\t\tif( \"value\" in changeRecord ) {\n\t\t\tif( this.lastUpdates.length > 0 && this.lastUpdates[ 0 ] === changeRecord.value.currentValue ) {\n\t\t\t\tthis.lastUpdates.shift();\n\t\t\t} else {\n\t\t\t\tthis.internallyChanged = true;\n\t\t\t\tthis.lastUpdates = [];\n\t\t\t\tthis.codeMirror.setValue( changeRecord.value.currentValue );\n\t\t\t}\n\t\t}\n\n\t}\n\n\tprivate normalizeTabs( value:string ):string {\n\t\tlet lines:string[] = value.split( /\\n/gm );\n\n\t\tif( ! lines[ 0 ].trim() ) lines.shift();\n\t\tif( ! lines[ lines.length - 1 ].trim() ) lines.pop();\n\n\t\tlet containsSomething:boolean = lines.reduce( ( previous, line ) => previous || ! ! line.trim(), false );\n\t\tif( ! containsSomething ) return \"\";\n\n\t\tlet tabs:boolean = null;\n\t\tlet extraIndentation:number = null;\n\t\tfor( let line of lines ) {\n\t\t\tif( ! line.trim() ) continue;\n\t\t\tif( tabs === null ) tabs = line.startsWith( \"\\t\" );\n\t\t\tlet indentation:number = this.getIndentation( line, tabs );\n\t\t\tif( extraIndentation === null || extraIndentation > indentation ) extraIndentation = indentation;\n\t\t}\n\n\t\tthis.removeIndentation( lines, extraIndentation, tabs );\n\n\t\treturn lines.length ? lines.join( \"\\n\" ) : \"\";\n\t}\n\n\tprivate getIndentation( line:string, tabs:boolean = true ):number {\n\t\tlet indentationChar:string = tabs ? \"\\t\" : \" \";\n\t\tfor( var i:number = 0, length = line.length; i < length; i ++ ) {\n\t\t\tif( line.charAt( i ) !== indentationChar ) break;\n\t\t}\n\t\treturn i;\n\t}\n\n\tprivate removeIndentation( lines:string[], indentation:number, tabs:boolean = true ):string[] {\n\t\tfor( let i:number = 0, length = lines.length; i < length; i ++ ) {\n\t\t\tlet line:string = lines[ i ];\n\t\t\tif( ! line.trim() ) continue;\n\t\t\tlines[ i ] = line.substring( indentation );\n\t\t}\n\t\treturn lines;\n\t}\n\n\tprivate setReadOnly( readOnly:boolean ):void {\n\t\tthis.codeMirror.setOption( \"readOnly\", readOnly );\n\t}\n\n\tprivate setNoCursor( noCursor:boolean ):void {\n\t\tif( noCursor ) this.codeMirror.setOption( \"readOnly\", \"nocursor\" );\n\t\telse this.setReadOnly( this.readOnly );\n\t}\n}\n\n\nexport class Mode {\n\tstatic get CSS():string { return \"text/css\"; };\n\n\tstatic get JAVASCRIPT():string { return \"text/javascript\"; }\n\n\tstatic get JSONLD():string { return \"application/ld+json\"; }\n\n\tstatic get JSONDRDF():string { return \"application/json\"; }\n\n\tstatic get N3():string { return \"text/turtle\"; }\n\n\tstatic get RDFXML():string { return \"application/xml\"; }\n\n\tstatic get CSV():string { return \"text/plain\"; }\n\n\tstatic get TSV():string { return \"text/plain\"; }\n\n\tstatic get SPARQL():string { return \"application/sparql-query\"; }\n\n\tstatic get XML():string { return \"application/xml\"; }\n\n\tstatic get TURTLE():string { return \"text/turtle\"; }\n}\n\nexport default Class;"]}