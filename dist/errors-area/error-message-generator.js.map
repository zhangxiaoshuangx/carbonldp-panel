{"version":3,"sources":["errors-area/error-message-generator.ts"],"names":[],"mappings":"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","file":"error-message-generator.js","sourcesContent":["import * as HTTP from \"carbonldp/HTTP\";\nimport * as JSONLDParser from \"carbonldp/JSONLD/Parser\";\n\nimport { Message } from \"./error-message.component\";\nimport { Error as HTTPError } from \"carbonldp/HTTP/Errors\";\n\n\nexport class ErrorMessageGenerator {\n\n\tpublic static getErrorMessage( error:HTTPError ):Message {\n\t\tlet errorMessage:Message = {\n\t\t\ttitle: \"\",\n\t\t\tcontent: \"\",\n\t\t\tstatusCode: \"\",\n\t\t\tstatusMessage: \"\",\n\t\t\tendpoint: \"\"\n\t\t};\n\n\t\terrorMessage.title = error.hasOwnProperty( \"name\" ) ? error.name : \"\";\n\t\terrorMessage.content = error.hasOwnProperty( \"message\" ) ? error.message : \"\";\n\n\t\t// If it's a HTTP error\n\t\tif( error.hasOwnProperty( \"statusCode\" ) ) {\n\t\t\terrorMessage.content = errorMessage.content === \"\" ? this.getFriendlyHTTPMessage( error ) : errorMessage.content;\n\t\t\terrorMessage.statusCode = error.hasOwnProperty( \"message\" ) ? \"\" + error.statusCode : \"\";\n\t\t\terrorMessage.statusMessage = ( <XMLHttpRequest>error.response.request ).statusText;\n\t\t\terrorMessage.title = errorMessage.statusMessage;\n\t\t\terrorMessage.endpoint = ( <any>error.response.request ).responseURL;\n\t\t\tif( ! ! error.response.data )\n\t\t\t\tthis.getErrors( error ).then( ( errors ) => { errorMessage[ \"errors\" ] = errors; } );\n\t\t} else if( error.hasOwnProperty( \"stack\" ) ) {\n\t\t\t// If it's an uncaught exception\n\t\t\terrorMessage.title = error.message;\n\t\t\terrorMessage.stack = error.stack;\n\t\t}\n\t\treturn errorMessage;\n\t}\n\n\tprivate static getErrors( error:HTTPError ):Promise<any[]> {\n\t\tlet parser:JSONLDParser.Class = new JSONLDParser.Class();\n\t\tlet mainError = {};\n\t\tlet errors:any[] = [];\n\t\treturn parser.parse( error.response.data ).then( ( mainErrors ) => {\n\t\t\tmainError = mainErrors.find( ( error ) => { return error[ \"@type\" ].indexOf( \"https://carbonldp.com/ns/v1/platform#ErrorResponse\" ) !== - 1} );\n\t\t\terrors = mainErrors.filter( ( error ) => { return error[ \"@type\" ].indexOf( \"https://carbonldp.com/ns/v1/platform#Error\" ) !== - 1} );\n\t\t\treturn errors;\n\t\t} );\n\t}\n\n\tprivate static getFriendlyHTTPMessage( error:HTTPError ):string {\n\t\tlet tempMessage:string = \"\";\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\ttempMessage = \"Forbidden Action.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.NotFoundError:\n\t\t\t\ttempMessage = \"Couldn't found the requested resource.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\ttempMessage = \"Unauthorized operation.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\ttempMessage = \"An internal error occurred while trying to fetch the resource. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\ttempMessage = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\t// TODO: Check if the UnknownError is due to a bad CORS configuration.\n\t\t\t\ttempMessage = \"An error occurred while trying to fetch the resource content. This could be caused by a missing allowed domain for your App. Please, make sure this is not the case and try again later.\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttempMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn tempMessage;\n\t}\n}\n\nexport default ErrorMessageGenerator;"]}