{"version":3,"sources":["errors-area/error-message-generator.ts"],"names":[],"mappings":"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","file":"error-message-generator.js","sourcesContent":["import * as HTTP from \"carbonldp/HTTP\";\nimport * as JSONLDParser from \"carbonldp/JSONLD/Parser\";\n\nimport { Message } from \"./error-message.component\";\nimport { Error as HTTPError } from \"carbonldp/HTTP/Errors\";\n\n\nexport class ErrorMessageGenerator {\n\n\tpublic static getErrorMessage( error:HTTPError ):Message {\n\t\tlet errorMessage:Message = {\n\t\t\ttitle: \"\",\n\t\t\tcontent: \"\",\n\t\t\tstatusCode: \"\",\n\t\t\tstatusMessage: \"\",\n\t\t\tendpoint: \"\"\n\t\t};\n\n\t\terrorMessage.title = error.hasOwnProperty( \"name\" ) ? error.name : \"\";\n\t\terrorMessage.content = error.hasOwnProperty( \"message\" ) ? error.message : \"\";\n\n\t\t// If it's a HTTP error\n\t\tif( error.hasOwnProperty( \"statusCode\" ) ) {\n\t\t\terrorMessage.content = errorMessage.content === \"\" ? this.getFriendlyHTTPMessage( error ) : errorMessage.content;\n\t\t\terrorMessage.statusCode = error.hasOwnProperty( \"message\" ) ? \"\" + error.statusCode : \"\";\n\t\t\terrorMessage.statusMessage = ( <XMLHttpRequest>error.response.request ).statusText;\n\t\t\terrorMessage.title = errorMessage.statusMessage;\n\t\t\terrorMessage.endpoint = ( <any>error.response.request ).responseURL;\n\t\t\tif( ! ! error.response.data )\n\t\t\t\tthis.getErrors( error ).then( ( errors )=> { errorMessage[ \"errors\" ] = errors; } );\n\t\t} else if( error.hasOwnProperty( \"stack\" ) ) {\n\t\t\t// If it's an uncaught exception\n\t\t\terrorMessage.title = error.message;\n\t\t\terrorMessage.stack = error.stack;\n\t\t}\n\t\treturn errorMessage;\n\t}\n\n\tprivate static getErrors( error:HTTPError ):Promise<any[]> {\n\t\tlet parser:JSONLDParser.Class = new JSONLDParser.Class();\n\t\tlet mainError = {};\n\t\tlet errors:any[] = [];\n\t\treturn parser.parse( error.response.data ).then( ( mainErrors )=> {\n\t\t\tmainError = mainErrors.find( ( error )=> { return error[ \"@type\" ].indexOf( \"https://carbonldp.com/ns/v1/platform#ErrorResponse\" ) !== - 1} );\n\t\t\terrors = mainErrors.filter( ( error )=> { return error[ \"@type\" ].indexOf( \"https://carbonldp.com/ns/v1/platform#Error\" ) !== - 1} );\n\t\t\treturn errors;\n\t\t} );\n\t}\n\n\tprivate static getFriendlyHTTPMessage( error:HTTPError ):string {\n\t\tlet tempMessage:string = \"\";\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\ttempMessage = \"Forbidden Action.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.NotFoundError:\n\t\t\t\ttempMessage = \"Couldn't found the requested resource.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\ttempMessage = \"Unauthorized operation.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\ttempMessage = \"An internal error occurred while trying to fetch the resource. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\ttempMessage = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\t// TODO: Check if the UnknownError is due to a bad CORS configuration.\n\t\t\t\ttempMessage = \"An error occurred while trying to fetch the resource content. This could be caused by a missing allowed domain for your App. Please, make sure this is not the case and try again later.\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttempMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn tempMessage;\n\t}\n}\n\nexport default ErrorMessageGenerator;"]}