{"version":3,"sources":["document-explorer/document-tree-view/document-tree-view.component.ts"],"names":[],"mappings":"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","file":"document-tree-view.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, EventEmitter, AfterViewInit, OnInit } from \"@angular/core\";\n\nimport * as Pointer from \"carbonldp/Pointer\";\nimport * as PersistedDocument from \"carbonldp/PersistedDocument\";\nimport * as HTTP from \"carbonldp/HTTP\";\nimport * as URI from \"carbonldp/RDF/URI\";\nimport * as SDKContext from \"carbonldp/SDKContext\";\nimport * as SPARQL from \"carbonldp/SPARQL\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport \"jstree/dist/jstree.min\";\n\nimport template from \"./document-tree-view.component.html!\";\nimport style from \"./document-tree-view.component.css!text\";\n\n@Component( {\n\tselector: \"cp-document-treeview\",\n\ttemplate: template,\n\tstyles: [ style ],\n} )\n\nexport class DocumentTreeViewComponent implements AfterViewInit, OnInit {\n\telement:ElementRef;\n\t$element:JQuery;\n\n\tjsTree:JSTree;\n\t$tree:JQuery;\n\tnodeChildren:JSTreeNode[] = [];\n\tprivate _selectedURI:string = \"\";\n\n\tset selectedURI( value:string ) {\n\t\tthis._selectedURI = value;\n\t\tthis.onSelectDocument.emit( this.selectedURI );\n\t}\n\n\tget selectedURI():string {\n\t\treturn this._selectedURI;\n\t}\n\n\t@Input() documentContext:SDKContext.Class;\n\t@Input() refreshNode:EventEmitter<string> = new EventEmitter<string>();\n\t@Input() openNode:EventEmitter<string> = new EventEmitter<string>();\n\t@Output() onResolveUri:EventEmitter<string> = new EventEmitter<string>();\n\t@Output() onError:EventEmitter<HTTP.Errors.Error> = new EventEmitter<HTTP.Errors.Error>();\n\t@Output() onLoadingDocument:EventEmitter<boolean> = new EventEmitter<boolean>();\n\t@Output() onShowCreateChildForm:EventEmitter<boolean> = new EventEmitter<boolean>();\n\t@Output() onShowDeleteChildForm:EventEmitter<boolean> = new EventEmitter<boolean>();\n\t@Output() onShowCreateAccessPointForm:EventEmitter<boolean> = new EventEmitter<boolean>();\n\t@Output() onSelectDocument:EventEmitter<string> = new EventEmitter<string>();\n\n\tconstructor( element:ElementRef ) {\n\t\tthis.element = element;\n\t}\n\n\tngOnInit():void {\n\t\tlet alreadyImported:boolean = document.querySelectorAll( \"head [href='assets/node_modules/jstree/dist/themes/default/style.min.css']\" ).length > 0;\n\t\tif( alreadyImported ) return;\n\t\tlet link:HTMLLinkElement = document.createElement( \"link\" );\n\t\tlink.rel = \"stylesheet\";\n\t\tlink.href = \"assets/node_modules/jstree/dist/themes/default/style.min.css\";\n\t\tlet head:Element = document.querySelector( \"head\" );\n\t\thead.appendChild( link );\n\t}\n\n\tngAfterViewInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.$tree = this.$element.find( \".treeview.content\" );\n\t\tthis.$element.find( \".treeview.options .dropdown.button\" ).dropdown( { action: \"hide\" } );\n\t\tthis.onLoadingDocument.emit( true );\n\t\tthis.getDocumentTree().then( () => {\n\t\t\tthis.onLoadingDocument.emit( false );\n\t\t} );\n\t\tthis.refreshNode.subscribe( ( nodeId:string ) => {\n\t\t\tthis.jsTree.select_node( nodeId );\n\t\t\tthis.loadNode( nodeId );\n\t\t} );\n\t\tthis.openNode.subscribe( ( nodeId:string ) => {\n\t\t\tthis.jsTree.select_node( nodeId );\n\t\t} );\n\t}\n\n\tgetDocumentTree():Promise<PersistedDocument.Class> {\n\t\treturn this.documentContext.documents.get( \"\" ).then( ( [ resolvedRoot, response ]:[ PersistedDocument.Class, HTTP.Response.Class ] ) => {\n\t\t\treturn resolvedRoot.refresh();\n\t\t} ).then( ( [ updatedRoot, updatedResponse ]:[ PersistedDocument.Class, HTTP.Response.Class ] ) => {\n\t\t\tthis.nodeChildren.push( this.buildNode( this.documentContext.getBaseURI(), \"default\", true ) );\n\t\t\tthis.renderTree();\n\n\t\t\treturn updatedRoot;\n\t\t} ).catch( ( error:HTTP.Errors.Error ) => {\n\t\t\tconsole.error( error );\n\t\t\tthis.onError.emit( error );\n\t\t} );\n\t}\n\n\tbuildNode( uri:string, nodeType?:string, hasChildren?:boolean ):JSTreeNode {\n\t\tlet node:JSTreeNode = {\n\t\t\tid: uri,\n\t\t\ttext: this.getSlug( uri ),\n\t\t\tstate: { \"opened\": false },\n\t\t\tchildren: [],\n\t\t\tdata: {},\n\t\t};\n\t\tif( nodeType === \"accesspoint\" ) node.type = \"accesspoint\";\n\t\tif( hasChildren ) node.children.push( { \"text\": \"Loading...\", } );\n\t\treturn node;\n\t}\n\n\trenderTree():void {\n\t\tthis.jsTree = this.$tree.jstree( {\n\t\t\t\"core\": {\n\t\t\t\t\"data\": this.nodeChildren,\n\t\t\t\t\"check_callback\": true,\n\t\t\t\t\"multiple\": false,\n\t\t\t},\n\t\t\t\"types\": {\n\t\t\t\t\"default\": {\n\t\t\t\t\t\"icon\": \"file outline icon\",\n\t\t\t\t},\n\t\t\t\t\"loading\": {\n\t\t\t\t\t\"icon\": \"spinner loading icon\",\n\t\t\t\t},\n\t\t\t\t\"accesspoint\": {\n\t\t\t\t\t\"icon\": \"selected radio icon\",\n\t\t\t\t\t\"a_attr\": {\n\t\t\t\t\t\t\"class\": \"accesspoint\",\n\t\t\t\t\t\t\"title\": \"The element is an AccessPoint, not a direct child of the selected document.\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"plugins\": [ \"types\", \"wholerow\" ],\n\t\t} ).jstree( true );\n\t\tthis.$tree.on( \"before_open.jstree\", ( e:Event, data:any ):void => {\n\t\t\tlet parentId:any = data.node.id;\n\t\t\tlet parentNode:any = data.node;\n\t\t\tlet position:string = \"last\";\n\t\t\tthis.onBeforeOpenNode( parentId, parentNode, position );\n\t\t} );\n\t\tthis.$tree.on( \"select_node.jstree\", ( e:Event, data:any ):void => {\n\t\t\tlet node:any = data.node;\n\t\t\tthis.selectedURI = node.id;\n\t\t} );\n\t\tthis.$tree.on( \"loaded.jstree\", () => {\n\t\t\tthis.jsTree.select_node( this.nodeChildren[ 0 ].id );\n\t\t\tthis.jsTree.open_node( this.nodeChildren[ 0 ].id );\n\t\t\tif( this.nodeChildren && this.nodeChildren.length > 0 ) {\n\t\t\t\tthis.onResolveUri.emit( <string>this.nodeChildren[ 0 ].id );\n\t\t\t}\n\t\t} );\n\t\tthis.$tree.on( \"dblclick.jstree\", \".jstree-anchor\", ( e:Event ) => {\n\t\t\tthis.loadNode( e.target );\n\t\t} );\n\t\tthis.$tree.on( \"dblclick.jstree\", \".jstree-wholerow\", ( e:Event ) => {\n\t\t\te.stopImmediatePropagation();\n\t\t\tlet tmpEvt:JQueryEventObject = $.Event( \"dblclick\" );\n\t\t\t$( e.currentTarget ).closest( \".jstree-node\" ).children( \".jstree-anchor\" ).first().trigger( tmpEvt ).focus();\n\t\t} );\n\t}\n\n\tloadNode( obj:any ):void {\n\t\tlet node:JSTreeNode = this.jsTree.get_node( obj );\n\t\tlet parentId:any = node.id;\n\t\tlet parentNode:any = node;\n\t\tlet position:string = \"last\";\n\t\tthis.onChange( parentId, parentNode, position );\n\t}\n\n\tonBeforeOpenNode( parentId:string, parentNode:any, position:string ):Promise<any> {\n\t\tlet originalIcon:string = ! ! this.jsTree.settings.types[ parentNode.type ] ? this.jsTree.settings.types[ parentNode.type ].icon : \"help icon\";\n\t\tthis.jsTree.set_icon( parentNode, this.jsTree.settings.types.loading.icon );\n\t\treturn this.getNodeChildren( parentNode.id ).then( ( children:any[] ):void => {\n\t\t\tthis.emptyNode( parentId );\n\t\t\tif( children.length > 0 ) {\n\t\t\t\tchildren.forEach( ( childNode:any ) => this.addChild( parentId, childNode, position ) );\n\t\t\t}\n\t\t} ).then( () => {\n\t\t\tthis.jsTree.set_icon( parentNode, originalIcon );\n\t\t} );\n\t}\n\n\tonChange( parentId:string, node:any, position:string ):void {\n\t\tthis.onBeforeOpenNode( parentId, node, position ).then( () => {\n\t\t\tif( ! this.jsTree.is_open( node ) ) {\n\t\t\t\tthis.jsTree.open_node( node );\n\t\t\t}\n\t\t\tthis.onResolveUri.emit( node.id );\n\t\t} );\n\t}\n\n\taddChild( parentId:string, node:any, position:string ):void {\n\t\tthis.jsTree.create_node( parentId, node, position );\n\t}\n\n\temptyNode( nodeId:string ):void {\n\t\tlet $children:JQuery = this.jsTree.get_children_dom( nodeId );\n\t\tlet childElements:Element[] = jQuery.makeArray( $children );\n\t\twhile( childElements.length > 0 ) {\n\t\t\tthis.jsTree.delete_node( childElements[ 0 ] );\n\t\t\tchildElements.splice( 0, 1 );\n\t\t}\n\t}\n\n\tgetNodeChildren( uri:string ):Promise<JSTreeNode[]> {\n\t\tlet query:string = `SELECT ?p ?o ?p2 ?o2 \n\t\t\tWHERE{\n\t\t\t\t<__URI__> ?p ?o VALUES (?p) \n\t\t\t\t{\n\t\t\t\t\t(<http://www.w3.org/ns/ldp#contains>)\n\t\t\t\t\t(<https://carbonldp.com/ns/v1/platform#accessPoint>)\n\t\t\t\t}\n\t\t\t\tOPTIONAL {\n\t\t\t\t\t?o ?p2 ?o2\tVALUES (?p2) \n\t\t\t\t\t{\t\t\n\t\t\t\t\t\t(<http://www.w3.org/ns/ldp#contains>)\t\n\t\t\t\t\t\t(<https://carbonldp.com/ns/v1/platform#accessPoint>)\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}`;\n\t\tquery = query.replace( \"__URI__\", uri );\n\n\t\treturn this.documentContext.documents.executeSELECTQuery( uri, query ).then( ( [ results, response ]:[ SPARQL.SELECTResults.Class, HTTP.Response.Class ] ) => {\n\t\t\tlet accessPoints:Map<string, boolean> = new Map<string, boolean>(),\n\t\t\t\tchildren:Map<string, boolean> = new Map<string, boolean>(),\n\t\t\t\tnodes:JSTreeNode[] = [];\n\n\t\t\tresults.bindings.forEach(\n\t\t\t\t( binding:{ p:Pointer.Class, o:Pointer.Class, p2:Pointer.Class, o2:Pointer.Class } ) => {\n\t\t\t\t\tif( binding.p.id !== \"http://www.w3.org/ns/ldp#contains\" || (! ! binding.o2 && binding.o2.id.indexOf( \"/agents/me/\" ) !== - 1 ) ) return;\n\t\t\t\t\tchildren.set( binding.o.id, children.get( binding.o.id ) ? true : ! ! binding.p2 );\n\t\t\t\t} );\n\t\t\tresults.bindings.forEach(\n\t\t\t\t( binding:{ p:Pointer.Class, o:Pointer.Class, p2:Pointer.Class, o2:Pointer.Class } ) => {\n\t\t\t\t\tif( binding.p.id !== \"https://carbonldp.com/ns/v1/platform#accessPoint\" ) return;\n\t\t\t\t\taccessPoints.set( binding.o.id, accessPoints.get( binding.o.id ) ? true : ! ! binding.p2 );\n\t\t\t\t} );\n\n\n\t\t\tchildren.forEach( ( hasChildren:boolean, id:string, children:Map<string,boolean> ) => {\n\t\t\t\tnodes.push( this.buildNode( id, \"default\", hasChildren ) );\n\t\t\t} );\n\t\t\taccessPoints.forEach( ( hasChildren:boolean, id:string, children:Map<string,boolean> ) => {\n\t\t\t\tnodes.push( this.buildNode( id, \"accesspoint\", hasChildren ) );\n\t\t\t} );\n\n\t\t\treturn nodes;\n\t\t} ).catch( ( error ) => {\n\t\t\tconsole.error( error );\n\t\t\treturn [];\n\t\t} );\n\t}\n\n\n\tgetSlug( pointer:Pointer.Class | string ):string {\n\t\tif( typeof pointer !== \"string\" ) return ( <Pointer.Class>pointer ).id;\n\t\treturn URI.Util.getSlug( <string>pointer );\n\t}\n\n\tshowCreateChildForm():void {\n\t\tthis.onShowCreateChildForm.emit( true );\n\t}\n\n\tshowCreateAccessPointForm():void {\n\t\tthis.onShowCreateAccessPointForm.emit( true );\n\t}\n\n\tshowDeleteChildForm():void {\n\t\tthis.onShowDeleteChildForm.emit( true );\n\t}\n\n}\n\nexport interface JSTreeNode {\n\tid:string,\n\ttext:any,\n\tstate:any,\n\tchildren:any,\n\tdata:any,\n\ttype?:any\n}\n\nexport default DocumentTreeViewComponent;"]}