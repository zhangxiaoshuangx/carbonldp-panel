{"version":3,"sources":["document-explorer/document-tree-view/document-tree-view.component.ts"],"names":[],"mappings":"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","file":"document-explorer/document-tree-view/document-tree-view.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, EventEmitter, AfterViewInit, OnInit } from \"@angular/core\";\n\nimport * as Pointer from \"carbonldp/Pointer\";\nimport * as PersistedDocument from \"carbonldp/PersistedDocument\";\nimport * as HTTP from \"carbonldp/HTTP\";\nimport * as URI from \"carbonldp/RDF/URI\";\nimport * as SDKContext from \"carbonldp/SDKContext\";\nimport * as RDFDocument from \"carbonldp/RDF/Document\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport \"jstree/dist/jstree.min\";\n\nimport template from \"./document-tree-view.component.html!\";\nimport style from \"./document-tree-view.component.css!text\";\n\n@Component( {\n\tselector: \"cp-document-treeview\",\n\ttemplate: template,\n\tstyles: [ style ],\n} )\n\nexport class DocumentTreeViewComponent implements AfterViewInit, OnInit {\n\telement:ElementRef;\n\t$element:JQuery;\n\n\tdocumentTree:JQuery;\n\tnodeChildren:JSTreeNode[] = [];\n\n\t@Input() documentContext:SDKContext.Class;\n\t@Input() refreshNode:EventEmitter<string> = new EventEmitter<string>();\n\t@Output() onResolveUri:EventEmitter<RDFDocument.Class> = new EventEmitter<RDFDocument.Class>();\n\t@Output() onError:EventEmitter<HTTP.Errors.Error> = new EventEmitter<HTTP.Errors.Error>();\n\t@Output() onLoadingDocument:EventEmitter<boolean> = new EventEmitter<boolean>();\n\n\tconstructor( element:ElementRef ) {\n\t\tthis.element = element;\n\t}\n\n\tngOnInit():void {\n\t\tlet alreadyImported:boolean = document.querySelectorAll( \"head [href='assets/node_modules/jstree/dist/themes/default/style.min.css']\" ).length > 0;\n\t\tif( alreadyImported ) return;\n\t\tlet link:HTMLLinkElement = document.createElement( \"link\" );\n\t\tlink.rel = \"stylesheet\";\n\t\tlink.href = \"assets/node_modules/jstree/dist/themes/default/style.min.css\";\n\t\tlet head:Element = document.querySelector( \"head\" );\n\t\thead.appendChild( link );\n\t}\n\n\tngAfterViewInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.documentTree = this.$element.find( \".document.treeview\" );\n\t\tthis.onLoadingDocument.emit( true );\n\t\tthis.getDocumentTree().then( ()=> {\n\t\t\tthis.onLoadingDocument.emit( false );\n\t\t} );\n\t\tthis.refreshNode.subscribe( ( nodeId:string )=> {\n\t\t\tlet tree:JSTree = this.documentTree.jstree( true );\n\t\t\ttree.close_node( nodeId );\n\t\t\ttree.open_node( nodeId );\n\t\t} );\n\t}\n\n\tgetDocumentTree():Promise<PersistedDocument.Class> {\n\t\treturn this.documentContext.documents.get( \"\" ).then( ( [ resolvedRoot, response ]:[ PersistedDocument.Class, HTTP.Response.Class ] ) => {\n\t\t\treturn resolvedRoot.refresh();\n\t\t} ).then( ( [updatedRoot, updatedResponse]:[PersistedDocument.Class, HTTP.Response.Class] ) => {\n\t\t\tthis.nodeChildren.push( this.buildNode( this.documentContext.getBaseURI() ) );\n\t\t\tthis.renderTree();\n\t\t} ).catch( ( error:HTTP.Errors.Error ) => {\n\t\t\tconsole.error( error );\n\t\t\tthis.onError.emit( error );\n\t\t} );\n\t}\n\n\tbuildNode( uri:string, isAccessPoint?:boolean ):JSTreeNode {\n\t\tlet node:JSTreeNode = {\n\t\t\tid: uri,\n\t\t\ttext: this.getSlug( uri ),\n\t\t\tstate: { \"opened\": false },\n\t\t\tchildren: [\n\t\t\t\t{ \"text\": \"Loading...\", },\n\t\t\t],\n\t\t\tdata: {},\n\t\t};\n\t\tif( isAccessPoint ) node.type = \"accesspoint\";\n\t\treturn node;\n\t}\n\n\trenderTree():void {\n\t\tthis.documentTree.jstree( {\n\t\t\t\"core\": {\n\t\t\t\t\"data\": this.nodeChildren,\n\t\t\t\t\"check_callback\": true,\n\t\t\t},\n\t\t\t\"types\": {\n\t\t\t\t\"default\": {\n\t\t\t\t\t\"icon\": \"file outline icon\",\n\t\t\t\t},\n\t\t\t\t\"loading\": {\n\t\t\t\t\t\"icon\": \"spinner loading icon\",\n\t\t\t\t},\n\t\t\t\t\"accesspoint\": {\n\t\t\t\t\t\"icon\": \"selected radio icon\",\n\t\t\t\t\t\"a_attr\": {\n\t\t\t\t\t\t\"class\": \"accesspoint\",\n\t\t\t\t\t\t\"title\": \"The element is an AccessPoint, not a direct child of the selected document.\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"plugins\": [ \"types\", \"wholerow\" ],\n\t\t} );\n\t\tthis.documentTree.jstree();\n\t\tthis.documentTree.on( \"create_node.jstree\", ( e:Event, data:any ):void => {} );\n\t\tthis.documentTree.on( \"before_open.jstree\", ( e:Event, data:any ):void => {\n\t\t\tlet parentId:any = data.node.id;\n\t\t\tlet parentNode:any = data.node;\n\t\t\tlet position:string = \"last\";\n\t\t\tthis.onBeforeOpenNode( parentId, parentNode, position );\n\t\t} );\n\t\tthis.documentTree.on( \"changed.jstree\", ( e:Event, data:any ):void => {\n\t\t\tif( data[ \"action\" ] !== \"select_node\" ) return;\n\t\t\tlet parentId:any = data.node.id;\n\t\t\tlet parentNode:any = data.node;\n\t\t\tlet position:string = \"last\";\n\t\t\tthis.onClickNode( parentId, parentNode, position );\n\t\t} );\n\t\tthis.documentTree.on( \"loaded.jstree\", ()=> {\n\t\t\tthis.documentTree.jstree( \"select_node\", this.nodeChildren[ 0 ].id );\n\t\t\tif( this.nodeChildren && this.nodeChildren.length > 0 ) {\n\t\t\t\tthis.onResolveUri.emit( <string>this.nodeChildren[ 0 ].id );\n\t\t\t}\n\t\t} );\n\t}\n\n\temptyNode( nodeId:string ):void {\n\t\tlet $children:JQuery = this.documentTree.jstree( true ).get_children_dom( nodeId );\n\t\tlet childElements:Element[] = jQuery.makeArray( $children );\n\t\twhile( childElements.length > 0 ) {\n\t\t\tthis.documentTree.jstree( true ).delete_node( childElements[ 0 ] );\n\t\t\tchildElements.splice( 0, 1 );\n\t\t}\n\t}\n\n\tonBeforeOpenNode( parentId:string, parentNode:any, position:string ):void {\n\t\tlet oldIcon:string = parentNode.icon;\n\t\tlet $documentTree:JSTree = this.documentTree.jstree( true );\n\n\t\t$documentTree.set_icon( parentNode, $documentTree.settings.types.loading.icon );\n\t\tthis.getNodeChildren( parentNode.id ).then( ( children:any[] ):void => {\n\t\t\tthis.emptyNode( parentId );\n\t\t\tif( children.length > 0 ) {\n\t\t\t\tchildren.forEach( ( childNode:any ) => this.addChild( parentId, childNode, position ) );\n\t\t\t}\n\t\t} ).then( () => {\n\t\t\t$documentTree.set_icon( parentNode, oldIcon );\n\t\t} );\n\t}\n\n\tonClickNode( parentId:string, node:any, position:string ):void {\n\t\tlet tree:JSTree = this.documentTree.jstree( true );\n\t\tif( tree.is_open( node ) ) {\n\t\t\tthis.onBeforeOpenNode( parentId, node, position );\n\t\t} else {\n\t\t\ttree.open_node( node );\n\t\t}\n\t\tthis.onResolveUri.emit( node.id );\n\t}\n\n\taddChild( parentId:string, node:any, position:string ):void {\n\t\tthis.documentTree.jstree( true ).create_node( parentId, node, position );\n\t}\n\n\tgetNodeChildren( uri:string ):Promise<JSTreeNode[]> {\n\t\treturn this.documentContext.documents.get( uri ).then( ( [resolvedRoot, response]:[PersistedDocument.Class, HTTP.Response.Class] ) => {\n\t\t\treturn resolvedRoot.refresh().then( ( [refreshedRoot, response]:[PersistedDocument.Class, HTTP.Response.Class] )=> {\n\t\t\t\tif( ! resolvedRoot.accessPoints && ! resolvedRoot.contains ) return [];\n\t\t\t\tlet accessPoints:JSTreeNode[] = [],\n\t\t\t\t\tchildren:JSTreeNode[] = [];\n\t\t\t\tif( ! ! resolvedRoot.contains ) {\n\t\t\t\t\tchildren = resolvedRoot.contains.filter( ( pointer:Pointer.Class ):boolean => {\n\t\t\t\t\t\treturn pointer.id.indexOf( \"/agents/me/\" ) === - 1;\n\t\t\t\t\t} ).map( ( pointer:Pointer.Class ):JSTreeNode => {\n\t\t\t\t\t\treturn this.buildNode( pointer.id );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tif( ! ! resolvedRoot.accessPoints ) {\n\t\t\t\t\taccessPoints = resolvedRoot.accessPoints.map( ( pointer:Pointer.Class ):JSTreeNode => {\n\t\t\t\t\t\treturn this.buildNode( pointer.id, true );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\treturn children.concat( accessPoints );\n\t\t\t} );\n\t\t} ).catch( ( error ) => {\n\t\t\tconsole.error( error );\n\t\t\treturn [];\n\t\t} );\n\t}\n\n\n\tgetSlug( pointer:Pointer.Class | string ):string {\n\t\tif( typeof pointer !== \"string\" ) return ( <Pointer.Class>pointer ).id;\n\n\t\treturn URI.Util.getSlug( <string>pointer );\n\t}\n\n}\n\nexport interface JSTreeNode {\n\tid:string,\n\ttext:any,\n\tstate:any,\n\tchildren:any,\n\tdata:any,\n\ttype?:any\n}\n\nexport default DocumentTreeViewComponent;"],"sourceRoot":"/source/"}