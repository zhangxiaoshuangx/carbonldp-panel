{"version":3,"sources":["document-explorer/document-tree-view/document-tree-view.component.ts"],"names":[],"mappings":"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","file":"document-tree-view.component.js","sourcesContent":["import { Component, ElementRef, Input, Output, EventEmitter, AfterViewInit, OnInit } from \"@angular/core\";\r\n\r\nimport * as Pointer from \"carbonldp/Pointer\";\r\nimport * as PersistedDocument from \"carbonldp/PersistedDocument\";\r\nimport * as HTTP from \"carbonldp/HTTP\";\r\nimport * as URI from \"carbonldp/RDF/URI\";\r\nimport * as SDKContext from \"carbonldp/SDKContext\";\r\nimport * as SPARQL from \"carbonldp/SPARQL\";\r\n\r\nimport $ from \"jquery\";\r\nimport \"semantic-ui/semantic\";\r\n\r\nimport \"jstree/dist/jstree.min\";\r\n\r\nimport template from \"./document-tree-view.component.html!\";\r\nimport style from \"./document-tree-view.component.css!text\";\r\n\r\n@Component( {\r\n\tselector: \"cp-document-treeview\",\r\n\ttemplate: template,\r\n\tstyles: [ style ],\r\n} )\r\n\r\nexport class DocumentTreeViewComponent implements AfterViewInit, OnInit {\r\n\telement:ElementRef;\r\n\t$element:JQuery;\r\n\r\n\tjsTree:JSTree;\r\n\t$tree:JQuery;\r\n\tnodeChildren:JSTreeNode[] = [];\r\n\tprivate _selectedURI:string = \"\";\r\n\r\n\tset selectedURI( value:string ) {\r\n\t\tthis._selectedURI = value;\r\n\t\tthis.onSelectDocument.emit( this.selectedURI );\r\n\t}\r\n\r\n\tget selectedURI():string {\r\n\t\treturn this._selectedURI;\r\n\t}\r\n\r\n\t@Input() documentContext:SDKContext.Class;\r\n\t@Input() refreshNode:EventEmitter<string> = new EventEmitter<string>();\r\n\t@Input() openNode:EventEmitter<string> = new EventEmitter<string>();\r\n\t@Output() onResolveUri:EventEmitter<string> = new EventEmitter<string>();\r\n\t@Output() onError:EventEmitter<HTTP.Errors.Error> = new EventEmitter<HTTP.Errors.Error>();\r\n\t@Output() onLoadingDocument:EventEmitter<boolean> = new EventEmitter<boolean>();\r\n\t@Output() onShowCreateChildForm:EventEmitter<boolean> = new EventEmitter<boolean>();\r\n\t@Output() onShowDeleteChildForm:EventEmitter<boolean> = new EventEmitter<boolean>();\r\n\t@Output() onShowCreateAccessPointForm:EventEmitter<boolean> = new EventEmitter<boolean>();\r\n\t@Output() onSelectDocument:EventEmitter<string> = new EventEmitter<string>();\r\n\r\n\tconstructor( element:ElementRef ) {\r\n\t\tthis.element = element;\r\n\t}\r\n\r\n\tngOnInit():void {\r\n\t\tlet alreadyImported:boolean = document.querySelectorAll( \"head [href='assets/node_modules/jstree/dist/themes/default/style.min.css']\" ).length > 0;\r\n\t\tif( alreadyImported ) return;\r\n\t\tlet link:HTMLLinkElement = document.createElement( \"link\" );\r\n\t\tlink.rel = \"stylesheet\";\r\n\t\tlink.href = \"assets/node_modules/jstree/dist/themes/default/style.min.css\";\r\n\t\tlet head:Element = document.querySelector( \"head\" );\r\n\t\thead.appendChild( link );\r\n\t}\r\n\r\n\tngAfterViewInit():void {\r\n\t\tthis.$element = $( this.element.nativeElement );\r\n\t\tthis.$tree = this.$element.find( \".treeview.content\" );\r\n\t\tthis.$element.find( \".treeview.options .dropdown.button\" ).dropdown( { action: \"hide\" } );\r\n\t\tthis.onLoadingDocument.emit( true );\r\n\t\tthis.getDocumentTree().then( ()=> {\r\n\t\t\tthis.onLoadingDocument.emit( false );\r\n\t\t} );\r\n\t\tthis.refreshNode.subscribe( ( nodeId:string )=> {\r\n\t\t\tthis.jsTree.select_node( nodeId );\r\n\t\t\tthis.loadNode( nodeId );\r\n\t\t} );\r\n\t\tthis.openNode.subscribe( ( nodeId:string )=> {\r\n\t\t\tthis.jsTree.select_node( nodeId );\r\n\t\t} );\r\n\t}\r\n\r\n\tgetDocumentTree():Promise<PersistedDocument.Class> {\r\n\t\treturn this.documentContext.documents.get( \"\" ).then( ( [ resolvedRoot, response ]:[ PersistedDocument.Class, HTTP.Response.Class ] ) => {\r\n\t\t\treturn resolvedRoot.refresh();\r\n\t\t} ).then( ( [updatedRoot, updatedResponse]:[PersistedDocument.Class, HTTP.Response.Class] ) => {\r\n\t\t\tthis.nodeChildren.push( this.buildNode( this.documentContext.getBaseURI(), \"default\", true ) );\r\n\t\t\tthis.renderTree();\r\n\r\n\t\t\treturn updatedRoot;\r\n\t\t} ).catch( ( error:HTTP.Errors.Error ) => {\r\n\t\t\tconsole.error( error );\r\n\t\t\tthis.onError.emit( error );\r\n\t\t} );\r\n\t}\r\n\r\n\tbuildNode( uri:string, nodeType?:string, hasChildren?:boolean ):JSTreeNode {\r\n\t\tlet node:JSTreeNode = {\r\n\t\t\tid: uri,\r\n\t\t\ttext: this.getSlug( uri ),\r\n\t\t\tstate: { \"opened\": false },\r\n\t\t\tchildren: [],\r\n\t\t\tdata: {},\r\n\t\t};\r\n\t\tif( nodeType === \"accesspoint\" ) node.type = \"accesspoint\";\r\n\t\tif( hasChildren ) node.children.push( { \"text\": \"Loading...\", } );\r\n\t\treturn node;\r\n\t}\r\n\r\n\trenderTree():void {\r\n\t\tthis.jsTree = this.$tree.jstree( {\r\n\t\t\t\"core\": {\r\n\t\t\t\t\"data\": this.nodeChildren,\r\n\t\t\t\t\"check_callback\": true,\r\n\t\t\t\t\"multiple\": false,\r\n\t\t\t},\r\n\t\t\t\"types\": {\r\n\t\t\t\t\"default\": {\r\n\t\t\t\t\t\"icon\": \"file outline icon\",\r\n\t\t\t\t},\r\n\t\t\t\t\"loading\": {\r\n\t\t\t\t\t\"icon\": \"spinner loading icon\",\r\n\t\t\t\t},\r\n\t\t\t\t\"accesspoint\": {\r\n\t\t\t\t\t\"icon\": \"selected radio icon\",\r\n\t\t\t\t\t\"a_attr\": {\r\n\t\t\t\t\t\t\"class\": \"accesspoint\",\r\n\t\t\t\t\t\t\"title\": \"The element is an AccessPoint, not a direct child of the selected document.\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\"plugins\": [ \"types\", \"wholerow\" ],\r\n\t\t} ).jstree( true );\r\n\t\tthis.$tree.on( \"before_open.jstree\", ( e:Event, data:any ):void => {\r\n\t\t\tlet parentId:any = data.node.id;\r\n\t\t\tlet parentNode:any = data.node;\r\n\t\t\tlet position:string = \"last\";\r\n\t\t\tthis.onBeforeOpenNode( parentId, parentNode, position );\r\n\t\t} );\r\n\t\tthis.$tree.on( \"select_node.jstree\", ( e:Event, data:any ):void => {\r\n\t\t\tlet node:any = data.node;\r\n\t\t\tthis.selectedURI = node.id;\r\n\t\t} );\r\n\t\tthis.$tree.on( \"loaded.jstree\", ()=> {\r\n\t\t\tthis.jsTree.select_node( this.nodeChildren[ 0 ].id );\r\n\t\t\tthis.jsTree.open_node( this.nodeChildren[ 0 ].id );\r\n\t\t\tif( this.nodeChildren && this.nodeChildren.length > 0 ) {\r\n\t\t\t\tthis.onResolveUri.emit( <string>this.nodeChildren[ 0 ].id );\r\n\t\t\t}\r\n\t\t} );\r\n\t\tthis.$tree.on( \"dblclick.jstree\", \".jstree-anchor\", ( e:Event ) => {\r\n\t\t\tthis.loadNode( e.target );\r\n\t\t} );\r\n\t\tthis.$tree.on( \"dblclick.jstree\", \".jstree-wholerow\", ( e:Event ) => {\r\n\t\t\te.stopImmediatePropagation();\r\n\t\t\tlet tmpEvt:JQueryEventObject = $.Event( \"dblclick\" );\r\n\t\t\t$( e.currentTarget ).closest( \".jstree-node\" ).children( \".jstree-anchor\" ).first().trigger( tmpEvt ).focus();\r\n\t\t} );\r\n\t}\r\n\r\n\tloadNode( obj:any ):void {\r\n\t\tlet node:JSTreeNode = this.jsTree.get_node( obj );\r\n\t\tlet parentId:any = node.id;\r\n\t\tlet parentNode:any = node;\r\n\t\tlet position:string = \"last\";\r\n\t\tthis.onChange( parentId, parentNode, position );\r\n\t}\r\n\r\n\tonBeforeOpenNode( parentId:string, parentNode:any, position:string ):Promise<any> {\r\n\t\tlet originalIcon:string = ! ! this.jsTree.settings.types[ parentNode.type ] ? this.jsTree.settings.types[ parentNode.type ].icon : \"help icon\";\r\n\t\tthis.jsTree.set_icon( parentNode, this.jsTree.settings.types.loading.icon );\r\n\t\treturn this.getNodeChildren( parentNode.id ).then( ( children:any[] ):void => {\r\n\t\t\tthis.emptyNode( parentId );\r\n\t\t\tif( children.length > 0 ) {\r\n\t\t\t\tchildren.forEach( ( childNode:any ) => this.addChild( parentId, childNode, position ) );\r\n\t\t\t}\r\n\t\t} ).then( () => {\r\n\t\t\tthis.jsTree.set_icon( parentNode, originalIcon );\r\n\t\t} );\r\n\t}\r\n\r\n\tonChange( parentId:string, node:any, position:string ):void {\r\n\t\tthis.onBeforeOpenNode( parentId, node, position ).then( ()=> {\r\n\t\t\tif( ! this.jsTree.is_open( node ) ) {\r\n\t\t\t\tthis.jsTree.open_node( node );\r\n\t\t\t}\r\n\t\t\tthis.onResolveUri.emit( node.id );\r\n\t\t} );\r\n\t}\r\n\r\n\taddChild( parentId:string, node:any, position:string ):void {\r\n\t\tthis.jsTree.create_node( parentId, node, position );\r\n\t}\r\n\r\n\temptyNode( nodeId:string ):void {\r\n\t\tlet $children:JQuery = this.jsTree.get_children_dom( nodeId );\r\n\t\tlet childElements:Element[] = jQuery.makeArray( $children );\r\n\t\twhile( childElements.length > 0 ) {\r\n\t\t\tthis.jsTree.delete_node( childElements[ 0 ] );\r\n\t\t\tchildElements.splice( 0, 1 );\r\n\t\t}\r\n\t}\r\n\r\n\tgetNodeChildren( uri:string ):Promise<JSTreeNode[]> {\r\n\t\tlet query:string = `SELECT ?p ?o ?p2 ?o2 \r\n\t\t\tWHERE{\r\n\t\t\t\t<__URI__> ?p ?o VALUES (?p) \r\n\t\t\t\t{\r\n\t\t\t\t\t(<http://www.w3.org/ns/ldp#contains>)\r\n\t\t\t\t\t(<https://carbonldp.com/ns/v1/platform#accessPoint>)\r\n\t\t\t\t}\r\n\t\t\t\tOPTIONAL {\r\n\t\t\t\t\t?o ?p2 ?o2\tVALUES (?p2) \r\n\t\t\t\t\t{\t\t\r\n\t\t\t\t\t\t(<http://www.w3.org/ns/ldp#contains>)\t\r\n\t\t\t\t\t\t(<https://carbonldp.com/ns/v1/platform#accessPoint>)\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}`;\r\n\t\tquery = query.replace( \"__URI__\", uri );\r\n\r\n\t\treturn this.documentContext.documents.executeSELECTQuery( uri, query ).then( ( [ results, response ]:[ SPARQL.SELECTResults.Class, HTTP.Response.Class ] )=> {\r\n\t\t\tlet accessPoints:Map<string, boolean> = new Map<string, boolean>(),\r\n\t\t\t\tchildren:Map<string, boolean> = new Map<string, boolean>(),\r\n\t\t\t\tnodes:JSTreeNode[] = [];\r\n\r\n\t\t\tresults.bindings.forEach(\r\n\t\t\t\t( binding:{p:Pointer.Class, o:Pointer.Class, p2:Pointer.Class, o2:Pointer.Class} )=> {\r\n\t\t\t\t\tif( binding.p.id !== \"http://www.w3.org/ns/ldp#contains\" || (! ! binding.o2 && binding.o2.id.indexOf( \"/agents/me/\" ) !== - 1 ) ) return;\r\n\t\t\t\t\tchildren.set( binding.o.id, children.get( binding.o.id ) ? true : ! ! binding.p2 );\r\n\t\t\t\t} );\r\n\t\t\tresults.bindings.forEach(\r\n\t\t\t\t( binding:{p:Pointer.Class, o:Pointer.Class, p2:Pointer.Class, o2:Pointer.Class} )=> {\r\n\t\t\t\t\tif( binding.p.id !== \"https://carbonldp.com/ns/v1/platform#accessPoint\" ) return;\r\n\t\t\t\t\taccessPoints.set( binding.o.id, accessPoints.get( binding.o.id ) ? true : ! ! binding.p2 );\r\n\t\t\t\t} );\r\n\r\n\r\n\t\t\tchildren.forEach( ( hasChildren:boolean, id:string, children:Map<string,boolean> )=> {\r\n\t\t\t\tnodes.push( this.buildNode( id, \"default\", hasChildren ) );\r\n\t\t\t} );\r\n\t\t\taccessPoints.forEach( ( hasChildren:boolean, id:string, children:Map<string,boolean> )=> {\r\n\t\t\t\tnodes.push( this.buildNode( id, \"accesspoint\", hasChildren ) );\r\n\t\t\t} );\r\n\r\n\t\t\treturn nodes;\r\n\t\t} ).catch( ( error ) => {\r\n\t\t\tconsole.error( error );\r\n\t\t\treturn [];\r\n\t\t} );\r\n\t}\r\n\r\n\r\n\tgetSlug( pointer:Pointer.Class | string ):string {\r\n\t\tif( typeof pointer !== \"string\" ) return ( <Pointer.Class>pointer ).id;\r\n\t\treturn URI.Util.getSlug( <string>pointer );\r\n\t}\r\n\r\n\tshowCreateChildForm():void {\r\n\t\tthis.onShowCreateChildForm.emit( true );\r\n\t}\r\n\r\n\tshowCreateAccessPointForm():void {\r\n\t\tthis.onShowCreateAccessPointForm.emit( true );\r\n\t}\r\n\r\n\tshowDeleteChildForm():void {\r\n\t\tthis.onShowDeleteChildForm.emit( true );\r\n\t}\r\n\r\n}\r\n\r\nexport interface JSTreeNode {\r\n\tid:string,\r\n\ttext:any,\r\n\tstate:any,\r\n\tchildren:any,\r\n\tdata:any,\r\n\ttype?:any\r\n}\r\n\r\nexport default DocumentTreeViewComponent;"]}