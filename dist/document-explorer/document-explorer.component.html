<div class="ui divided grid segment" [ngClass]="{loading:loadingDocument || savingDocument}">

	<div class="stretched row">
		<div class="error messages" *ngIf="messages.length > 0">
			<template ngFor let-message="$implicit" [ngForOf]="messages" let-i="index">
				<cp-error-message [message]="message" [closable]="true"></cp-error-message>
			</template>
		</div>
		<cp-document-treeview class="five wide column treeview-container"
		                      [documentContext]="documentContext"
		                      [refreshNode]="onRefreshNode"
		                      [openNode]="onOpenNode"

		                      (onSelectDocument)="changeSelection($event)"
		                      (onShowCreateChildForm)="documentCreator.show()"
		                      (onShowDeleteChildForm)="showModal(deleteDocumentModal)"
		                      (onShowCreateAccessPointForm)="accessPointCreator.show()"
		                      (onError)="handleExternalError($event)"
		                      (onLoadingDocument)="onLoadingDocument($event)"
		                      (onResolveUri)="resolveDocument($event)"></cp-document-treeview>
		<cp-document-viewer class="eleven wide column"
		                    [document]="inspectingDocument"
		                    [documentContext]="documentContext"
		                    [displaySuccessMessage]="onDisplaySuccessMessage"

		                    (onError)="handleExternalError($event)"
		                    (onRefreshNode)="refreshNode($event)"
		                    (onOpenNode)="openNode($event)"
		                    (onSavingDocument)="showLoading($event)"
		                    (onLoadingDocument)="onLoadingDocument($event)"
		                    (onRefreshDocument)="refreshDocument($event)"></cp-document-viewer>
		<cp-document-creator #documentCreator
		                     [context]="documentContext"
		                     [parentURI]="selectedDocumentURI"
		                     (onSuccess)="onSuccessAccessPoint($event)"></cp-document-creator>
		<cp-access-point-creator #accessPointCreator
		                         [context]="documentContext"
		                         [parentURI]="selectedDocumentURI"
		                         (onSuccess)="onSuccessAccessPoint($event)"></cp-access-point-creator>
		<div class="ui delete document basic modal" #deleteDocumentModal>
			<div class="header">
				<h2 class="ui inverted header"><i class="trash outline red icon"></i> Are you sure?</h2>
			</div>
			<div class="content">
				<p class="ui description">
					<span>You are about to delete the following document:</span>
					<span>'{{selectedDocumentURI}}'</span><br><br>
					<span>If you delete it, all its children and its access points will also be deleted.</span><br>
					<span>Do you really want to proceed?</span>
				</p>
			</div>
			<div class="actions">
				<div class="ui button" title="Cancel deletion" (click)="cancelDeletion()">No</div>
				<div class="ui red button" title="Confirm deletion" (click)="deleteDocument()">Yes</div>
			</div>
		</div>
	</div>
</div>