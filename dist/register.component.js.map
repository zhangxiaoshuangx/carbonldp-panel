{"version":3,"sources":["register.component.ts"],"names":[],"mappings":"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","file":"register.component.js","sourcesContent":["import { Component, ElementRef, Output, Inject, EventEmitter, OnInit } from \"@angular/core\";\n\nimport { FormBuilder, ControlGroup, AbstractControl, Validators, Control } from \"@angular/common/src/forms-deprecated\";\nimport * as HTTP from \"carbonldp/HTTP\";\n\nimport { AuthService } from \"angular2-carbonldp/services\";\n\nimport { EmailValidator, SameAsValidator } from \"carbon-panel/custom-validators\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport template from \"./register.component.html!\"\n\n@Component( {\n\tselector: \"cp-register\",\n\ttemplate: template,\n\tstyles: [],\n} )\nexport class RegisterComponent implements OnInit {\n\t@Output( \"onRegister\" ) onRegister:EventEmitter<any> = new EventEmitter<any>();\n\n\tprivate element:ElementRef;\n\tprivate $element:JQuery;\n\tprivate formBuilder:FormBuilder;\n\tprivate authService:AuthService.Class;\n\n\tprivate sending:boolean = false;\n\tprivate registerForm:ControlGroup;\n\tprivate controls:{\n\t\tname?:AbstractControl,\n\t\temail?:AbstractControl,\n\t\tpassword?:AbstractControl,\n\t\trepeatPassword?:AbstractControl,\n\t\tprofileId?:AbstractControl,\n\t} = {};\n\tprivate errorMessage:string = \"\";\n\n\tconstructor( element:ElementRef, formBuilder:FormBuilder, @Inject( AuthService.Token ) authService:AuthService.Class ) {\n\t\tthis.element = element;\n\t\tthis.formBuilder = formBuilder;\n\t\tthis.authService = authService;\n\t}\n\n\tngOnInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\n\t\tthis.registerForm = this.formBuilder.group( {\n\t\t\tname: [ \"\", Validators.compose( [ Validators.required ] ) ],\n\t\t\temail: [ \"\", Validators.compose( [ Validators.required, EmailValidator ] ) ],\n\t\t\tpassword: [ \"\", Validators.compose( [ Validators.required ] ) ],\n\t\t\tprofileId: [ \"\", Validators.compose( [] ) ],\n\t\t} );\n\n\t\tthis.controls.name = this.registerForm.controls[ \"name\" ];\n\t\tthis.controls.email = this.registerForm.controls[ \"email\" ];\n\t\tthis.controls.password = this.registerForm.controls[ \"password\" ];\n\t\tthis.controls.profileId = this.registerForm.controls[ \"profileId\" ];\n\n\t\tthis.controls.repeatPassword = this.formBuilder.control( \"\", Validators.compose( [ Validators.required, SameAsValidator( this.controls.password ) ] ) );\n\t\tthis.registerForm.addControl( \"repeatPassword\", this.controls.repeatPassword );\n\n\n\t\tlet valueCopy:string = \"\";\n\t\tthis.controls.profileId.valueChanges.subscribe( ( value:string )=> {\n\t\t\tvalueCopy = this.getSanitizedSlug( value );\n\t\t\tif( value !== valueCopy )(<Control>this.controls.profileId).updateValue( valueCopy );\n\t\t} );\n\t}\n\n\tonSubmit( data:{ name:string, email:string, password:string, profileId:string }, $event:any ):void {\n\t\t$event.preventDefault();\n\n\t\tthis.sending = true;\n\t\tthis.errorMessage = \"\";\n\n\t\tthis.touchControls();\n\n\t\tif( ! this.registerForm.valid ) {\n\t\t\tthis.shakeForm();\n\t\t\tthis.sending = false;\n\t\t\treturn;\n\t\t}\n\n\t\tlet name:string = data.name;\n\t\tlet username:string = data.email;\n\t\tlet password:string = data.password;\n\t\tlet profileId:string = data.profileId;\n\n\t\tif( ! profileId ) profileId = void 0;\n\n\t\tthis.authService.register( name, username, password, profileId ).then( () => {\n\t\t\tthis.sending = false;\n\t\t\tthis.onRegister.emit( null );\n\t\t} ).catch( ( error:any ) => {\n\t\t\tthis.sending = false;\n\t\t\tthis.setErrorMessage( error );\n\t\t} );\n\t}\n\n\tgetSanitizedSlug( slug:string ):string {\n\t\treturn slug.toLowerCase().replace( / - | -|- /g, \"-\" ).replace( /[^-\\w ]+/g, \"\" ).replace( / +/g, \"-\" );\n\t}\n\n\ttouchControls():void {\n\t\tfor( let controlName in this.controls ) {\n\t\t\tif( ! this.controls.hasOwnProperty( controlName ) ) continue;\n\n\t\t\tlet control:AbstractControl = this.controls[ controlName ];\n\t\t\tcontrol.markAsTouched();\n\t\t}\n\t}\n\n\tshakeForm():void {\n\t\tlet target:JQuery = this.$element;\n\t\ttarget.transition( {\n\t\t\tanimation: \"shake\",\n\t\t} );\n\t}\n\n\tsetErrorMessage( error:HTTP.Errors.Error ):void {\n\t\tif( typeof error.message !== \"undefined\" ) this.errorMessage = error.message;\n\t\telse switch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.ConflictError:\n\t\t\t\tthis.errorMessage = \"That email is already in use\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\tthis.errorMessage = \"Denied Access\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\tthis.errorMessage = \"Wrong credentials\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.BadGatewayError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.GatewayTimeoutError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\tthis.errorMessage = \"Service currently unavailable\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif( \"response\" in error ) {\n\t\t\t\t\tthis.errorMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\t} else {\n\t\t\t\t\tthis.errorMessage = \"There was a problem processing the request\";\n\t\t\t\t\tconsole.error( error );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport default RegisterComponent;\n"],"sourceRoot":"/source/"}