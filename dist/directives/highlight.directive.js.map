{"version":3,"sources":["directives/highlight.directive.ts"],"names":[],"mappings":"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","file":"highlight.directive.js","sourcesContent":["import { Directive, ElementRef, AfterViewInit } from \"@angular/core\";\n\nimport Highlight from \"highlight.js\";\nimport \"highlight.js/styles/tomorrow-night.css!\";\n\n@Directive( {\n\tselector: \"[cpHighlight]\",\n} )\nexport class HighlightDirective implements AfterViewInit {\n\tconstructor( private element:ElementRef ) {}\n\n\tngAfterViewInit():void {\n\t\tlet html:string = this.element.nativeElement.innerHTML ? this.element.nativeElement.innerHTML : \"\";\n\t\tthis.element.nativeElement.innerHTML = this.normalizeTabs( html );\n\n\t\tHighlight.configure( {\n\t\t\ttabReplace: \"    \",\n\t\t} );\n\t\tHighlight.highlightBlock( this.element.nativeElement );\n\t}\n\n\tprivate normalizeTabs( value:string ):string {\n\t\tlet lines:string[] = value.split( /\\n/gm );\n\n\t\tif( ! lines[ 0 ].trim() ) lines.shift();\n\t\tif( lines.length > 0 && ! lines[ lines.length - 1 ].trim() ) lines.pop();\n\n\t\tlet containsSomething:boolean = lines.reduce( ( previous, line ) => previous || ! ! line.trim(), false );\n\t\tif( ! containsSomething ) return \"\";\n\n\t\tlet tabs:boolean = null;\n\t\tlet extraIndentation:number = null;\n\t\tfor( let line of lines ) {\n\t\t\tif( ! line.trim() ) continue;\n\t\t\tif( tabs === null ) tabs = line.startsWith( \"\\t\" );\n\t\t\tlet indentation:number = this.getIndentation( line, tabs );\n\t\t\tif( extraIndentation === null || extraIndentation > indentation ) extraIndentation = indentation;\n\t\t}\n\n\t\tthis.removeIndentation( lines, extraIndentation, tabs );\n\n\t\treturn lines.length ? lines.join( \"\\n\" ) : \"\";\n\t}\n\n\tprivate getIndentation( line:string, tabs:boolean = true ):number {\n\t\tlet indentationChar:string = tabs ? \"\\t\" : \" \";\n\t\tfor( var i:number = 0, length = line.length; i < length; i ++ ) {\n\t\t\tif( line.charAt( i ) !== indentationChar ) break;\n\t\t}\n\t\treturn i;\n\t}\n\n\tprivate removeIndentation( lines:string[], indentation:number, tabs:boolean = true ):string[] {\n\t\tfor( let i:number = 0, length = lines.length; i < length; i ++ ) {\n\t\t\tlet line:string = lines[ i ];\n\t\t\tif( ! line.trim() ) continue;\n\t\t\tlines[ i ] = line.substring( indentation );\n\t\t}\n\t\treturn lines;\n\t}\n}\n\nexport default HighlightDirective;\n"]}