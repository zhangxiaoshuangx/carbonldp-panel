{"version":3,"sources":["login.component.ts"],"names":[],"mappings":"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","file":"login.component.js","sourcesContent":["import {Component, ElementRef, Input, Output, EventEmitter, Inject} from \"@angular/core\";\n// import {NgForm} from \"@angular/common\";\nimport {NgForm} from \"@angular/forms\";\n\nimport {AuthService} from \"angular2-carbonldp/services\";\n\nimport Credentials from \"carbonldp/Auth/Credentials\";\nimport * as HTTP from \"carbonldp/HTTP\";\n\nimport {EmailValidator, PasswordValidator} from \"carbon-panel/custom-validators\";\n\nimport $ from \"jquery\";\nimport \"semantic-ui/semantic\";\n\nimport template from \"./login.component.html!\";\n\n@Component( {\n\tselector: \"cp-login\",\n\ttemplate: template,\n\tdirectives: [ NgForm, EmailValidator, PasswordValidator ],\n} )\nexport class LoginComponent {\n\t@Input() container:string|JQuery;\n\t@Output() onLogin:EventEmitter<Credentials> = new EventEmitter<Credentials>();\n\n\tsending:boolean = false;\n\terrorMessage:string = \"\";\n\n\tmodel:{ username:string, password:string } = {\n\t\tusername: \"\",\n\t\tpassword: \"\",\n\t};\n\n\tremember:boolean = true;\n\n\tconsole:typeof console = console;\n\n\tprivate $element:JQuery;\n\tprivate $loginForm:JQuery;\n\n\tconstructor( private element:ElementRef, @Inject( AuthService.Token ) private authService:AuthService.Class ) {}\n\n\tngOnInit():void {\n\t\tthis.$element = $( this.element.nativeElement );\n\t\tthis.$loginForm = this.$element.find( \"form.loginForm\" );\n\t\tthis.$loginForm.find( \".ui.checkbox\" ).checkbox();\n\t}\n\n\tonSubmit( data:{ email:string, password:string, rememberMe:boolean }, $event:any ):void {\n\t\t$event.preventDefault();\n\t\tthis.sending = true;\n\t\tthis.errorMessage = \"\";\n\t\t// this.email.markAsTouched();\n\t\t// this.password.markAsTouched();\n\t\t// if( ! this.loginForm.valid ) {\n\t\t// \tthis.shakeForm();\n\t\t// \tthis.sending = false;\n\t\t// \treturn;\n\t\t// }\n\n\t\tlet username:string = data.email;\n\t\tlet password:string = data.password;\n\t\tlet rememberMe:boolean = ! ! data.rememberMe;\n\n\t\tthis.authService.login( username, password, rememberMe ).then( ( credentials:Credentials ) => {\n\t\t\tthis.sending = false;\n\t\t\tthis.onLogin.emit( credentials );\n\t\t} ).catch( ( error:HTTP.Errors.Error ) => {\n\t\t\tthis.sending = false;\n\t\t\tthis.setErrorMessage( error );\n\t\t} );\n\t}\n\n\tgetDays( firstDate:Date, lastDate:Date ):number {\n\t\t// Discard the time and time-zone information\n\t\tlet utc1:number = Date.UTC( firstDate.getFullYear(), firstDate.getMonth(), firstDate.getDate() );\n\t\tlet utc2:number = Date.UTC( lastDate.getFullYear(), lastDate.getMonth(), lastDate.getDate() );\n\t\tlet msPerDay:number = 1000 * 60 * 60 * 24;\n\t\treturn Math.floor( (utc2 - utc1) / msPerDay );\n\t}\n\n\tsetErrorMessage( error:HTTP.Errors.Error ):void {\n\t\tswitch( true ) {\n\t\t\tcase error instanceof HTTP.Errors.ForbiddenError:\n\t\t\t\tthis.errorMessage = \"Denied Access.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnauthorizedError:\n\t\t\t\tthis.errorMessage = \"Wrong credentials.\";\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.BadGatewayError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.GatewayTimeoutError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.InternalServerErrorError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.UnknownError:\n\t\t\t\tthis.errorMessage = \"An error occurred while trying to login. Please try again later. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t\tcase error instanceof HTTP.Errors.ServiceUnavailableError:\n\t\t\t\tthis.errorMessage = \"Service currently unavailable.\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.errorMessage = \"There was a problem processing the request. Error: \" + error.response.status;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tshakeForm():void {\n\t\tlet target:JQuery = this.$element.find( \".formContainer\" );\n\t\tif( this.container ) {\n\t\t\ttarget = $( this.container );\n\t\t}\n\t\tif( target ) {\n\t\t\ttarget.transition( {\n\t\t\t\tanimation: \"shake\",\n\t\t\t} );\n\t\t}\n\t}\n}\n\nexport default LoginComponent;\n"],"sourceRoot":"/source/"}